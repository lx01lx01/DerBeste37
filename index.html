<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
<title>DerBeste37</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>

<link href="https://fonts.googleapis.com/css2?family=Syne:wght@600;700;800&family=DM+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">

<style>
:root{
  --green:#00e87a;
  --green-dim:rgba(0,232,122,0.12);
  --green-glow:rgba(0,232,122,0.25);
  --tg:#2AABEE;
  --wa:#25d366;
  --bg:#0d1a14;
  --surface:rgba(255,255,255,0.04);
  --border:rgba(255,255,255,0.08);
  --text:rgba(255,255,255,0.9);
  --text-dim:rgba(255,255,255,0.45);

  /* Category accent colors */
  --cali:#00e87a;
  --frozen:#64d8ff;
  --static:#ff6b35;
  --anon:#b388ff;
  --olive:#d4a843;
}

*{ margin:0; padding:0; box-sizing:border-box; }

html { scrollbar-gutter: stable; }
body{
  font-family:'DM Sans',sans-serif;
  background:var(--bg);
  color:var(--text);
  overflow-x:hidden;
  min-height:100vh;
  background-image:
    radial-gradient(ellipse 140% 55% at 30% -5%, rgba(0,232,122,0.13), transparent 65%),
    radial-gradient(ellipse 120% 45% at 75% 20%, rgba(0,232,122,0.07), transparent 55%),
    radial-gradient(ellipse 200% 90% at 60% 115%, rgba(0,130,255,0.22), transparent 70%),
    radial-gradient(ellipse 150% 70% at 20% 100%, rgba(0,150,255,0.15), transparent 65%),
    radial-gradient(ellipse 130% 60% at 90% 95%, rgba(0,120,255,0.13), transparent 60%);
}

h1,h2,h3,.hero-badge,.section-title,.price,.info-name{ font-family:'Syne',sans-serif; }

/* ─── HERO ─── */
.hero{
  position:relative;
  height:38vh;
  min-height:200px;
  max-height:260px;
  overflow:hidden;
}
.hero img{
  width:100%; height:100%;
  object-fit:cover;
  object-position:center 70%;
  filter:brightness(0.5) saturate(1.1);
  transform:scale(1.04);
  transition:transform 10s ease;
}
.hero img.loaded{ transform:scale(1); }
.hero::before{
  content:''; position:absolute; inset:0;
  background:linear-gradient(160deg, rgba(0,0,0,0.2) 0%, transparent 50%, rgba(0,0,0,0.6) 100%);
  z-index:1;
}
/* Grain overlay */
.hero-grain{
  position:absolute; inset:0; z-index:2; pointer-events:none;
  opacity:0.055;
  background-image:url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
  background-size:180px 180px;
  mix-blend-mode:overlay;
}
.hero::after{
  content:''; position:absolute; bottom:0; left:0; right:0; height:75%;
  background:linear-gradient(to top, var(--bg) 35%, rgba(13,26,20,0.8) 65%, transparent 100%);
  z-index:1;
}
.hero-overlay{
  position:absolute; bottom:28px; left:22px; z-index:2;
}

/* ─── HERO ANIMATIONS ─── */
@keyframes hero-fade-up{
  0%{ opacity:0; transform:translateY(22px); }
  100%{ opacity:1; transform:translateY(0); }
}
@keyframes underline-draw{
  0%{ width:0; opacity:0; }
  100%{ width:100%; opacity:1; }
}
@keyframes badge-in{
  0%{ opacity:0; transform:translateY(14px) scale(0.95); }
  100%{ opacity:1; transform:translateY(0) scale(1); }
}

.hero-badge{
  display:inline-flex; align-items:center; gap:6px;
  background:rgba(0,232,122,0.12);
  border:1px solid rgba(0,232,122,0.35);
  color:var(--green); font-size:10px; font-weight:700;
  letter-spacing:2.5px; text-transform:uppercase;
  padding:4px 10px; border-radius:30px; margin-bottom:8px;
  backdrop-filter:blur(8px);
  opacity:0;
  animation:badge-in 0.6s cubic-bezier(.2,.8,.3,1) 0.2s forwards;
}

.hero-overlay h1{
  font-size:30px; font-weight:800; letter-spacing:-0.5px; line-height:1.05;
  display:flex; align-items:baseline; gap:4px; color:#ffffff;
  text-shadow:0 0 40px rgba(255,255,255,0.18), 0 4px 30px rgba(0,0,0,0.6);
  opacity:0;
  animation:hero-fade-up 0.7s cubic-bezier(.2,.8,.3,1) 0.45s forwards;
}

/* DerBeste text with animated underline */
.hero-derbeste{
  position:relative; display:inline-block;
}
.hero-derbeste::after{
  content:'';
  position:absolute; bottom:-4px; left:0;
  height:2px;
  background:linear-gradient(90deg, var(--green), transparent);
  border-radius:2px;
  width:0; opacity:0;
  animation:underline-draw 0.7s cubic-bezier(.4,0,.2,1) 1.1s forwards;
}

/* 37 gradient blanc → vert */
.hero-num{
  font-size:50px; letter-spacing:-2px; font-weight:800;
  background:linear-gradient(135deg, #ffffff 30%, var(--green) 100%);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  background-clip:text;
  display:inline-block;
  filter:drop-shadow(0 0 18px rgba(0,232,122,0.35));
}

.hero-overlay p{
  color:var(--text-dim); margin-top:4px; font-size:12px; font-weight:300; letter-spacing:0.8px;
  opacity:0;
  animation:hero-fade-up 0.6s cubic-bezier(.2,.8,.3,1) 0.7s forwards;
}

/* ─── TICKER ─── */
.ticker-wrap{
  overflow:hidden;
  background:rgba(0,232,122,0.05);
  border-top:1px solid rgba(0,232,122,0.1);
  border-bottom:1px solid rgba(0,232,122,0.1);
  padding:10px 0;
}
.ticker{ display:flex; width:max-content; animation:ticker 24s linear infinite; }
.ticker-item{
  white-space:nowrap; padding:0 24px;
  font-size:11px; font-weight:600; letter-spacing:1.5px;
  text-transform:uppercase; color:var(--green); opacity:0.8;
}
@keyframes ticker{
  0%{ transform:translateX(0); }
  100%{ transform:translateX(-50%); }
}

/* ─── CATEGORY NAV ─── */
.cat-nav{
  position:sticky; top:0; z-index:100;
  background:rgba(13,26,20,0.85);
  backdrop-filter:blur(20px);
  -webkit-backdrop-filter:blur(20px);
  border-bottom:1px solid rgba(255,255,255,0.06);
  padding:0 18px;
  overflow-x:auto;
  scrollbar-width:none;
}
.cat-nav-fade{
  position:sticky; top:0; z-index:101; pointer-events:none;
  height:52px; margin-top:-52px;
  background:linear-gradient(to left, rgba(13,26,20,0.9) 0%, transparent 60%);
  margin-right:0;
}
.cat-nav::-webkit-scrollbar{ display:none; }
.cat-nav-inner{
  display:flex; gap:4px; padding:10px 0; width:max-content; min-width:100%;
}
.cat-tab{
  display:flex; align-items:center; gap:6px;
  padding:8px 14px; border-radius:30px;
  font-size:11px; font-weight:700; letter-spacing:1px;
  text-transform:uppercase; text-decoration:none; cursor:pointer;
  border:1px solid transparent;
  background:rgba(255,255,255,0.05);
  color:var(--text-dim);
  white-space:nowrap;
  transition:all 0.25s;
  font-family:'DM Sans',sans-serif;
}
.cat-tab:hover{ color:var(--text); background:rgba(255,255,255,0.08); }
.cat-tab.active-cali  { background:rgba(0,232,122,0.12);   border-color:rgba(0,232,122,0.35);   color:var(--cali); }
.cat-tab.active-frozen{ background:rgba(100,216,255,0.12); border-color:rgba(100,216,255,0.35); color:var(--frozen); }
.cat-tab.active-static{ background:rgba(255,107,53,0.12);  border-color:rgba(255,107,53,0.35);  color:var(--static); }
.cat-tab.active-anon  { background:rgba(179,136,255,0.12); border-color:rgba(179,136,255,0.35); color:var(--anon); }
.cat-tab.active-olive { background:rgba(212,168,67,0.12);  border-color:rgba(212,168,67,0.35);  color:var(--olive); }

/* ─── CONTAINER ─── */
.container{ padding:32px 18px 60px; max-width:560px; margin:auto; }

/* ─── CATEGORY SECTION ─── */
.cat-section{ margin-bottom:40px; }
.cat-section.grid-2 .products-grid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:10px;
}
.cat-section.grid-2 .products-grid .product{
  margin-bottom:0;
}
/* ─── 2-col card sizing ─── */
.cat-section.grid-2 .product{ padding:12px; }
.cat-section.grid-2 .product h3{ font-size:15px; letter-spacing:-0.2px; }
.cat-section.grid-2 .product p{ font-size:11.5px; line-height:1.5; margin-bottom:10px; }
.cat-section.grid-2 .product-header{ flex-direction:column; align-items:flex-start; gap:5px; margin-bottom:8px; }
.cat-section.grid-2 .product-tag{ font-size:9px; padding:3px 8px; white-space:normal; word-break:break-word; max-width:100%; }
.cat-section.grid-2 .price{ gap:4px; margin-bottom:10px; flex-direction:column; }
.cat-section.grid-2 .price-pill{ font-size:11px; padding:4px 8px; text-align:center; }
.cat-section.grid-2 .btn-row{ flex-direction:row; gap:6px; }
.cat-section.grid-2 .buy-btn{ font-size:11px; padding:10px 4px; gap:3px; border-radius:12px; letter-spacing:0; }
.cat-section.grid-2 .video-wrapper{ margin-bottom:10px; }
.cat-section.grid-2 .video-wrapper .fs-btn{
  position:absolute; bottom:7px; right:7px; z-index:10;
  width:32px; height:32px; border-radius:9px;
  background:rgba(0,0,0,0.6);
  backdrop-filter:blur(6px);
  -webkit-backdrop-filter:blur(6px);
  border:1px solid rgba(255,255,255,0.2);
  display:flex; align-items:center; justify-content:center;
  cursor:pointer; transition:background 0.2s, transform 0.15s;
  -webkit-tap-highlight-color:transparent;
}
.cat-section.grid-2 .video-wrapper .fs-btn:active{
  background:rgba(0,232,122,0.35); transform:scale(0.9);
}
.cat-section.grid-2 .video-wrapper .fs-btn svg{
  width:14px; height:14px; fill:none; stroke:#fff; stroke-width:2;
  stroke-linecap:round; stroke-linejoin:round;
}

/* ─── VIDEO MODAL ─── */
.vid-modal{
  display:none;
  position:fixed; inset:0; z-index:9999;
  background:rgba(0,0,0,0.95);
  flex-direction:column;
  align-items:center; justify-content:center;
  padding:0;
  -webkit-overflow-scrolling:touch;
}
.vid-modal.open{ display:flex; }
.vid-modal-inner{
  position:relative;
  width:100%;
  padding-top:56.25%;
}
.vid-modal-inner iframe{
  position:absolute; top:0; left:0; width:100%; height:100%; border:0;
}
.vid-modal-close{
  position:absolute; top:16px; right:16px; z-index:10;
  width:38px; height:38px; border-radius:50%;
  background:rgba(255,255,255,0.12);
  border:1px solid rgba(255,255,255,0.2);
  display:flex; align-items:center; justify-content:center;
  cursor:pointer; font-size:18px; color:#fff;
  -webkit-tap-highlight-color:transparent;
  transition:background 0.2s;
}
.vid-modal-close:active{ background:rgba(255,255,255,0.25); }

.cat-header{
  display:flex; align-items:center; gap:14px;
  margin-bottom:20px; padding:18px 20px;
  border-radius:20px;
  position:relative; overflow:hidden;
}
.cat-header::before{
  content:''; position:absolute; inset:0; opacity:0.06;
  background:var(--cat-color); border-radius:20px;
}
.cat-header-border{ border:1px solid var(--cat-color); opacity:0.25; border-radius:20px; }

.cat-icon{ font-size:32px; flex-shrink:0; }

.cat-header-text{}
.cat-label{
  font-size:9px; font-weight:700; letter-spacing:3px;
  text-transform:uppercase; color:var(--cat-color); margin-bottom:4px; opacity:0.8;
}
.cat-name{
  font-family:'Syne',sans-serif; font-size:22px; font-weight:800;
  letter-spacing:-0.3px; color:var(--text);
}
.cat-sub{ font-size:12px; color:var(--text-dim); margin-top:3px; font-weight:300; }

/* Category color variants */
.section-cali  { --cat-color:var(--cali); }
.section-frozen{ --cat-color:var(--frozen); }
.section-static{ --cat-color:var(--static); }
.section-anon  { --cat-color:var(--anon); }
.section-olive { --cat-color:var(--olive); }

/* ─── PRODUCT CARD ─── */
.product{
  background:var(--surface);
  border:1px solid var(--border);
  border-radius:24px; padding:16px; margin-bottom:14px;
  transition:transform 0.4s cubic-bezier(.2,.8,.3,1), border-color 0.4s, box-shadow 0.4s;
  display:flex; flex-direction:column;
}
.product.cali-card:hover,   .product.cali-card.lit   { border-color:rgba(0,232,122,0.85);   box-shadow:0 0 0 1px rgba(0,232,122,0.5), 0 0 28px rgba(0,232,122,0.35),   0 16px 48px rgba(0,232,122,0.25);   transform:translateY(-3px); }
.product.frozen-card:hover, .product.frozen-card.lit { border-color:rgba(100,216,255,0.85); box-shadow:0 0 0 1px rgba(100,216,255,0.5), 0 0 28px rgba(100,216,255,0.35), 0 16px 48px rgba(100,216,255,0.25); transform:translateY(-3px); }
.product.static-card:hover, .product.static-card.lit { border-color:rgba(255,107,53,0.85);  box-shadow:0 0 0 1px rgba(255,107,53,0.5),  0 0 28px rgba(255,107,53,0.35),  0 16px 48px rgba(255,107,53,0.25);  transform:translateY(-3px); }
.product.anon-card:hover,   .product.anon-card.lit   { border-color:rgba(179,136,255,0.85); box-shadow:0 0 0 1px rgba(179,136,255,0.5), 0 0 28px rgba(179,136,255,0.35), 0 16px 48px rgba(179,136,255,0.25); transform:translateY(-3px); }
.product.olive-card:hover,  .product.olive-card.lit  { border-color:rgba(212,168,67,0.85);  box-shadow:0 0 0 1px rgba(212,168,67,0.5),  0 0 28px rgba(212,168,67,0.35),  0 16px 48px rgba(212,168,67,0.25);  transform:translateY(-3px); }

.video-wrapper{
  position:relative; padding-top:56.25%;
  border-radius:16px; overflow:hidden;
  margin-bottom:14px; background:#0a0a0a;
}
.video-wrapper iframe{
  position:absolute; top:0; left:0; width:100%; height:100%; border:0;
}

/* Video placeholder */
.video-placeholder{
  position:absolute; top:0; left:0; width:100%; height:100%;
  display:flex; flex-direction:column; align-items:center; justify-content:center;
  gap:8px; background:rgba(255,255,255,0.03);
  border:1px dashed rgba(255,255,255,0.1); border-radius:16px;
}
.video-placeholder span{ font-size:28px; }
.video-placeholder p{ font-size:10px; color:var(--text-dim); letter-spacing:1.5px; text-transform:uppercase; }

.product-header{
  display:flex; justify-content:space-between; align-items:flex-start; margin-bottom:8px; gap:8px;
}
.product h3{ font-size:19px; font-weight:700; letter-spacing:-0.3px; flex:1; }

.product-tag{
  font-family:'DM Sans',sans-serif; font-size:11px; font-weight:600;
  padding:4px 10px; border-radius:20px; letter-spacing:0.3px;
  white-space:nowrap; flex-shrink:0;
}
.tag-cali  { background:rgba(0,232,122,0.1);   color:var(--cali);   border:1px solid rgba(0,232,122,0.2); }
.tag-frozen{ background:rgba(100,216,255,0.1); color:var(--frozen); border:1px solid rgba(100,216,255,0.2); }
.tag-static{ background:rgba(255,107,53,0.1);  color:var(--static); border:1px solid rgba(255,107,53,0.2); }
.tag-anon  { background:rgba(179,136,255,0.1); color:var(--anon);   border:1px solid rgba(179,136,255,0.2); }
.tag-olive { background:rgba(212,168,67,0.1);  color:var(--olive);  border:1px solid rgba(212,168,67,0.2); }
.tag-top   { background:rgba(255,215,0,0.1);   color:#ffd700;       border:1px solid rgba(255,215,0,0.2); }

.product p{ font-size:13px; color:var(--text-dim); margin-bottom:12px; line-height:1.6; font-weight:300; flex-grow:1; }

.price{
  font-family:'Syne',sans-serif; font-weight:700; font-size:13px;
  margin-bottom:14px; letter-spacing:0.3px;
  display:flex; flex-wrap:wrap; gap:6px;
  margin-top:0;
}
.price-pill{
  padding:4px 10px; border-radius:20px; background:rgba(255,255,255,0.05);
  border:1px solid rgba(255,255,255,0.09); font-size:12px; color:var(--text);
}
.price-pill.cali-pill   { border-color:rgba(0,232,122,0.2);   color:var(--cali); }
.price-pill.frozen-pill { border-color:rgba(100,216,255,0.2); color:var(--frozen); }
.price-pill.static-pill { border-color:rgba(255,107,53,0.2);  color:var(--static); }
.price-pill.anon-pill   { border-color:rgba(179,136,255,0.2); color:var(--anon); }
.price-pill.olive-pill  { border-color:rgba(212,168,67,0.2);  color:var(--olive); }

.btn-row{ display:flex; gap:10px; margin-top:auto; padding-top:4px; }

.buy-btn{
  display:flex; align-items:center; justify-content:center; gap:7px;
  padding:13px; border-radius:16px; font-family:'DM Sans',sans-serif;
  font-weight:600; font-size:14px; text-decoration:none; flex:1;
  transition:transform 0.2s, box-shadow 0.2s;
  position:relative; overflow:hidden;
}
.buy-btn::after{
  content:''; position:absolute; inset:0;
  background:rgba(255,255,255,0.1); opacity:0; transition:opacity 0.2s;
}
.buy-btn:active::after{ opacity:1; }
.buy-btn:active{ transform:scale(0.97); }
.buy-btn.telegram{
  background:linear-gradient(135deg,#2AABEE,#1a8ec7); color:white;
  box-shadow:0 4px 20px rgba(42,171,238,0.2);
}
.buy-btn.telegram:hover{ box-shadow:0 6px 28px rgba(42,171,238,0.4); transform:translateY(-2px); }
.buy-btn.whatsapp{
  background:linear-gradient(135deg,#25d366,#1aab4f); color:white;
  box-shadow:0 4px 20px rgba(37,211,102,0.2);
}
.buy-btn.whatsapp:hover{ box-shadow:0 6px 28px rgba(37,211,102,0.4); transform:translateY(-2px); }

/* ─── HUBBA BANNER ─── */
.hubba-banner{
  position:relative; overflow:hidden;
  border:1px solid rgba(212,168,67,0.35);
  border-radius:20px; padding:18px 18px 14px;
  margin-bottom:16px;
  background:linear-gradient(135deg, rgba(212,168,67,0.07), rgba(212,168,67,0.02));
}
.hubba-banner-glow{
  position:absolute; top:-30px; right:-30px;
  width:120px; height:120px; border-radius:50%;
  background:radial-gradient(circle, rgba(212,168,67,0.15), transparent 70%);
  pointer-events:none;
}
.hubba-banner-inner{
  display:flex; align-items:center; gap:12px; margin-bottom:12px;
}
.hubba-icon{ font-size:30px; flex-shrink:0; }
.hubba-text{ flex:1; }
.hubba-title{
  font-family:'Syne',sans-serif; font-size:15px; font-weight:800;
  color:var(--olive); letter-spacing:-0.2px;
}
.hubba-sub{ font-size:11px; color:var(--text-dim); margin-top:3px; font-weight:300; }
.hubba-badge{
  font-size:9px; font-weight:700; letter-spacing:1.5px;
  text-transform:uppercase; padding:5px 10px;
  background:rgba(212,168,67,0.12); border:1px solid rgba(212,168,67,0.3);
  border-radius:20px; color:var(--olive); white-space:nowrap;
}
.hubba-strains{
  display:flex; gap:8px; flex-wrap:wrap;
}
.hubba-strains span{
  font-size:11px; font-weight:600; padding:5px 12px;
  background:rgba(212,168,67,0.06); border:1px solid rgba(212,168,67,0.18);
  border-radius:30px; color:rgba(212,168,67,0.8);
}
.hubba-card{
  border-top:2px solid rgba(212,168,67,0.3) !important;
  padding-top:0 !important;
  overflow:hidden;
}
.hubba-strip{
  background:linear-gradient(90deg, rgba(212,168,67,0.15), transparent);
  border-bottom:1px solid rgba(212,168,67,0.12);
  padding:7px 14px; margin:-16px -16px 14px;
  font-size:10px; font-weight:700; letter-spacing:1.8px;
  text-transform:uppercase; color:var(--olive); opacity:0.85;
}
.tag-hubba{
  background:rgba(255,107,53,0.1); color:var(--static);
  border:1px solid rgba(255,107,53,0.2);
  font-family:'DM Sans',sans-serif; font-size:11px; font-weight:600;
  padding:4px 10px; border-radius:20px; letter-spacing:0.3px;
}

/* ─── ANONYMUZ STRAINS ─── */
.anon-strains{
  display:flex; flex-direction:column; gap:0;
  border:1px solid rgba(179,136,255,0.15);
  border-radius:14px; overflow:hidden; margin-bottom:4px;
}
.anon-strain-item{
  padding:11px 14px;
  border-bottom:1px solid rgba(179,136,255,0.1);
  transition:background 0.2s;
}
.anon-strain-item:last-child{ border-bottom:none; }
.anon-strain-item:hover{ background:rgba(179,136,255,0.06); }
.anon-strain-name{
  font-family:'Syne',sans-serif; font-size:14px; font-weight:700;
  color:var(--text); margin-bottom:3px;
}
.anon-strain-desc{
  font-size:12px; color:var(--text-dim); font-weight:300; line-height:1.5;
}

/* ─── FESTIVE SLOT ─── */
.festive-section{ margin-bottom:40px; }

.festive-teaser{
  position:relative; overflow:hidden;
  border:1px solid rgba(255,200,80,0.28);
  border-radius:24px; padding:0;
  background:linear-gradient(135deg, rgba(255,200,80,0.06), rgba(255,100,180,0.04), rgba(0,200,255,0.03));
}
.festive-teaser-strip{
  background:linear-gradient(90deg, rgba(255,200,80,0.14), transparent);
  border-bottom:1px solid rgba(255,200,80,0.1);
  padding:7px 16px;
  font-size:10px; font-weight:700; letter-spacing:2px;
  text-transform:uppercase; color:#ffbf47;
}
.festive-teaser-body{ padding:16px; }
.festive-placeholder{
  position:relative; padding-top:56.25%;
  border-radius:16px; overflow:hidden;
  margin-bottom:14px;
  background:rgba(255,200,80,0.03);
  border:1.5px dashed rgba(255,200,80,0.2);
}
.festive-placeholder-inner{
  position:absolute; top:0; left:0; width:100%; height:100%;
  display:flex; flex-direction:column; align-items:center; justify-content:center; gap:10px;
}
.festive-placeholder-inner .big-emoji{
  font-size:44px;
  animation:pulse-festive 2.8s ease-in-out infinite;
}
.festive-placeholder-inner .label{
  font-size:11px; font-weight:700; letter-spacing:2px;
  text-transform:uppercase; color:#ffbf47; opacity:0.75;
}
.festive-placeholder-inner .sublabel{
  font-size:10px; color:var(--text-dim); font-weight:300; letter-spacing:0.5px;
}
@keyframes pulse-festive{
  0%,100%{ transform:scale(1) rotate(-2deg); opacity:0.8; }
  50%{ transform:scale(1.15) rotate(2deg); opacity:1; }
}
.festive-info-row{
  display:flex; align-items:center; gap:10px;
  margin-bottom:10px;
}
.festive-name{
  font-family:'Syne',sans-serif; font-size:19px; font-weight:800;
  color:var(--text); letter-spacing:-0.3px; flex:1;
}
.tag-festive{
  font-family:'DM Sans',sans-serif; font-size:11px; font-weight:600;
  background:rgba(255,200,80,0.1); color:#ffbf47;
  border:1px solid rgba(255,200,80,0.25);
  padding:4px 10px; border-radius:20px; white-space:nowrap;
}
.festive-desc{
  font-size:13px; color:var(--text-dim); font-weight:300; line-height:1.6;
  margin-bottom:14px;
}
.festive-notify-btn{
  display:flex; align-items:center; justify-content:center; gap:8px;
  padding:14px; border-radius:16px; font-family:'DM Sans',sans-serif;
  font-weight:600; font-size:14px; text-decoration:none; width:100%;
  background:linear-gradient(135deg, rgba(255,200,80,0.15), rgba(255,200,80,0.06));
  border:1px solid rgba(255,200,80,0.3); color:#ffbf47;
  transition:all 0.2s;
}
.festive-notify-btn:hover{
  background:linear-gradient(135deg, rgba(255,200,80,0.25), rgba(255,200,80,0.1));
  box-shadow:0 6px 28px rgba(255,200,80,0.15);
  transform:translateY(-2px);
}
.festive-notify-btn:active{ transform:scale(0.97); }

/* ─── TOP FARM BANNER ─── */
.top-farm-banner{
  display:flex; align-items:center; gap:10px;
  padding:12px 16px; border-radius:14px; margin-bottom:12px;
  background:linear-gradient(135deg, rgba(179,136,255,0.1), rgba(255,215,0,0.06));
  border:1px solid rgba(179,136,255,0.25);
}
.top-farm-banner span{ font-size:18px; }
.top-farm-banner div{ font-size:11px; font-weight:700; letter-spacing:1.5px; text-transform:uppercase; color:#b388ff; }
.top-farm-banner p{ font-size:11px; color:var(--text-dim); font-weight:300; margin-top:2px; letter-spacing:0; text-transform:none; }

/* ─── WHY US ─── */
.why-grid{ display:grid; grid-template-columns:repeat(3,1fr); gap:8px; margin-bottom:20px; }
.why-card{
  background:var(--surface); border:1px solid var(--border);
  border-radius:18px; padding:16px 10px; text-align:center;
  transition:border-color 0.3s, transform 0.3s;
}
.why-card:hover{ border-color:rgba(0,232,122,0.25); transform:translateY(-3px); }
.why-icon{ font-size:28px; margin-bottom:10px; display:block; }
.why-label{ font-size:11px; font-weight:600; color:var(--text-dim); line-height:1.4; letter-spacing:0.3px; }

/* ─── INFO ─── */
.info-header{
  background:linear-gradient(135deg, rgba(0,232,122,0.08), rgba(0,232,122,0.02));
  border:1px solid rgba(0,232,122,0.18);
  border-radius:20px; padding:20px; margin-bottom:12px; text-align:center;
}
.info-name{ font-size:20px; font-weight:800; color:var(--green); letter-spacing:-0.3px; }
.info-sub{ font-size:13px; color:var(--text-dim); margin-top:5px; font-weight:300; }
.info-row{ display:flex; gap:10px; margin-bottom:10px; }
.info-block{
  flex:1; background:var(--surface); border:1px solid var(--border);
  border-radius:18px; padding:16px;
}
.block-icon{ font-size:20px; margin-bottom:8px; display:block; }
.block-title{
  font-size:10px; color:var(--text-dim); letter-spacing:2px;
  text-transform:uppercase; margin-bottom:6px; font-weight:500;
}
.block-text{ font-size:13px; font-weight:600; line-height:1.7; }

/* ─── HORAIRES ─── */
.horaires-box{ background:var(--surface); border:1px solid var(--border); border-radius:18px; padding:18px; margin-bottom:10px; }
.horaire-row{
  display:flex; justify-content:space-between; align-items:center;
  padding:9px 0; border-bottom:1px solid rgba(255,255,255,0.04);
}
.horaire-row:last-child{ border-bottom:none; padding-bottom:0; }
.horaire-row:first-of-type{ padding-top:0; }
.horaire-day{ font-size:13px; color:var(--text-dim); font-weight:400; }
.horaire-time{ font-size:13px; font-weight:600; }

/* ─── PRODUITS TAGS ─── */
.produits-box{ background:var(--surface); border:1px solid var(--border); border-radius:18px; padding:18px; }
.produits-grid{ display:flex; flex-wrap:wrap; gap:8px; }
.produit-tag{
  background:rgba(255,255,255,0.05); border:1px solid rgba(255,255,255,0.09);
  border-radius:30px; padding:6px 14px; font-size:12px; font-weight:500; color:var(--text);
  transition:border-color 0.25s, background 0.25s, color 0.25s;
}
.produit-tag:hover{ border-color:rgba(0,232,122,0.3); background:var(--green-dim); color:var(--green); }
.flag-tag{ background:rgba(255,255,255,0.04); border-color:rgba(255,255,255,0.12); color:var(--text-dim); font-size:12px; }

/* ─── CONTACT ─── */
.contact-item{
  display:flex; align-items:center; gap:14px; padding:16px;
  background:var(--surface); border:1px solid var(--border); border-radius:18px;
  margin-bottom:10px; text-decoration:none; color:var(--text);
  transition:border-color 0.3s, transform 0.3s, box-shadow 0.3s;
}
.contact-item:hover{ border-color:rgba(255,255,255,0.15); box-shadow:0 8px 30px rgba(0,0,0,0.2); transform:translateY(-2px); }
.contact-item:active{ transform:scale(0.98); }
.contact-icon-wrap{
  width:44px; height:44px; border-radius:14px;
  display:flex; align-items:center; justify-content:center; font-size:20px; flex-shrink:0;
}
.contact-icon-wrap.tg{ background:rgba(42,171,238,0.15); }
.contact-icon-wrap.wa{ background:rgba(37,211,102,0.15); }
.contact-label{ font-size:11px; color:var(--text-dim); margin-bottom:3px; letter-spacing:0.5px; }
.contact-value{ font-size:15px; font-weight:600; }

/* ─── SECTION TITLE ─── */
.section-title{
  font-size:11px; font-weight:700; letter-spacing:3.5px;
  text-transform:uppercase; margin-bottom:18px; color:var(--green);
  display:flex; align-items:center; gap:12px;
}
.section-title::after{
  content:''; flex:1; height:1px;
  background:linear-gradient(to right, rgba(0,232,122,0.25), transparent);
}

/* ─── FOOTER ─── */
.footer{ text-align:center; margin-top:48px; padding-bottom:20px; }
.footer-line{ width:40px; height:1px; background:rgba(255,255,255,0.1); margin:0 auto 14px; }
.footer-text{
  font-family:'Syne',sans-serif; font-size:11px; color:var(--text-dim);
  letter-spacing:2px; text-transform:uppercase; font-weight:700;
}

/* ─── SCROLL REVEAL ─── */
.reveal{ opacity:1; transform:translateY(0); transition:opacity 0.65s cubic-bezier(.2,.8,.3,1), transform 0.65s cubic-bezier(.2,.8,.3,1); }
.js-ready .reveal{ opacity:0; transform:translateY(28px); }
.js-ready .reveal.visible{ opacity:1; transform:translateY(0); }


/* ─── AURORA BACKGROUND ─── */
.aurora{
  position:fixed; inset:0; z-index:0;
  pointer-events:none; overflow:hidden;
}
.aurora-orb{
  position:absolute; border-radius:50%;
  filter:blur(80px);
  animation:aurora-drift linear infinite;
  will-change:transform;
  opacity:0.55;
}
.a1{ width:70vw; height:70vw; background:radial-gradient(circle, rgba(0,232,122,0.35), transparent 70%);
     top:-10%; left:-15%; animation-duration:18s; }
.a2{ width:60vw; height:60vw; background:radial-gradient(circle, rgba(179,136,255,0.3), transparent 70%);
     top:20%; right:-20%; animation-duration:22s; animation-delay:-6s; }
.a3{ width:75vw; height:75vw; background:radial-gradient(circle, rgba(255,210,0,0.2), transparent 70%);
     bottom:-15%; left:10%; animation-duration:26s; animation-delay:-10s; }
.a4{ width:55vw; height:55vw; background:radial-gradient(circle, rgba(0,200,200,0.25), transparent 70%);
     bottom:10%; right:-10%; animation-duration:20s; animation-delay:-4s; }
.a5{ width:65vw; height:65vw; background:radial-gradient(circle, rgba(0,232,122,0.2), transparent 70%);
     top:45%; left:25%; animation-duration:30s; animation-delay:-15s; }

@keyframes aurora-drift{
  0%  { transform:translate(0,0) scale(1); }
  25% { transform:translate(4vw, 5vh) scale(1.05); }
  50% { transform:translate(-3vw, 8vh) scale(0.97); }
  75% { transform:translate(5vw, -4vh) scale(1.03); }
  100%{ transform:translate(0,0) scale(1); }
}

.container{ position:relative; z-index:1; }

/* ─── SPLASH SCREEN ─── */
#splash{
  position:fixed; inset:0; z-index:9999;
  background:var(--bg);
  display:flex; flex-direction:column;
  align-items:center; justify-content:center; gap:16px;
  transition:opacity 0.6s ease, transform 0.6s ease;
}
#splash.hide{
  opacity:0; transform:scale(1.04); pointer-events:none;
}
.splash-logo{
  font-family:'Syne',sans-serif; font-weight:800;
  font-size:32px; letter-spacing:-1px;
  display:flex; align-items:baseline; gap:4px;
  animation:splash-in 0.7s cubic-bezier(.2,.8,.3,1) forwards;
  opacity:0;
}
.splash-logo-text{ color:#ffffff; }
.splash-logo-num{
  font-size:56px; letter-spacing:-3px;
  background:linear-gradient(135deg, #ffffff 30%, var(--green) 100%);
  -webkit-background-clip:text; -webkit-text-fill-color:transparent;
  background-clip:text;
  filter:drop-shadow(0 0 20px rgba(0,232,122,0.4));
}
.splash-sub{
  font-family:'DM Sans',sans-serif; font-size:11px;
  letter-spacing:3px; text-transform:uppercase;
  color:var(--green); opacity:0;
  animation:splash-in 0.6s cubic-bezier(.2,.8,.3,1) 0.3s forwards;
}
.splash-bar-wrap{
  width:80px; height:2px; border-radius:2px;
  background:rgba(255,255,255,0.1); overflow:hidden;
  opacity:0; animation:splash-in 0.5s ease 0.5s forwards;
}
.splash-bar{
  height:100%; width:0; border-radius:2px;
  background:linear-gradient(90deg, var(--green), rgba(0,232,122,0.4));
  animation:splash-load 1.2s cubic-bezier(.4,0,.2,1) 0.6s forwards;
}
@keyframes splash-in{
  from{ opacity:0; transform:translateY(12px); }
  to  { opacity:1; transform:translateY(0); }
}
@keyframes splash-load{
  from{ width:0; } to{ width:100%; }
}

/* ─── BACK TO TOP ─── */
#backTop{
  position:fixed; bottom:22px; right:18px; z-index:500;
  width:42px; height:42px; border-radius:14px;
  background:rgba(0,232,122,0.12);
  border:1px solid rgba(0,232,122,0.3);
  display:flex; align-items:center; justify-content:center;
  cursor:pointer; opacity:0; pointer-events:none;
  transition:opacity 0.3s, transform 0.3s, box-shadow 0.3s;
  backdrop-filter:blur(10px);
  -webkit-tap-highlight-color:transparent;
}
#backTop.visible{
  opacity:1; pointer-events:auto;
}
#backTop:active{
  transform:scale(0.92);
  box-shadow:0 0 16px rgba(0,232,122,0.3);
}
#backTop svg{
  width:16px; height:16px; stroke:var(--green);
  fill:none; stroke-width:2.5; stroke-linecap:round; stroke-linejoin:round;
}

/* ─── BADGE NOUVEAUTÉ ─── */
.tag-new{
  background:rgba(0,232,122,0.12); color:var(--green);
  border:1px solid rgba(0,232,122,0.35);
  font-family:'DM Sans',sans-serif; font-size:9px; font-weight:700;
  padding:3px 8px; border-radius:20px; letter-spacing:1px;
  text-transform:uppercase; white-space:nowrap;
  animation:pulse-new 2s ease-in-out infinite;
}
@keyframes pulse-new{
  0%,100%{ box-shadow:0 0 0 0 rgba(0,232,122,0.3); }
  50%{ box-shadow:0 0 0 4px rgba(0,232,122,0); }
}

/* ─── MINIMUM COMMANDE ─── */
.min-order-banner{
  display:flex; align-items:center; gap:10px;
  padding:10px 18px;
  background:rgba(255,255,255,0.03);
  border-top:1px solid rgba(255,255,255,0.05);
  border-bottom:1px solid rgba(255,255,255,0.05);
  font-family:'DM Sans',sans-serif; font-size:12px;
  color:rgba(255,255,255,0.6); letter-spacing:0.3px;
}
@media(max-width:600px){ .hero-overlay h1{ font-size:28px; } .hero-num{ font-size:50px; } }
/* ─── BACKGROUND CANVAS ─── */
#bgCanvas{
  position:fixed; inset:0; z-index:0;
  pointer-events:none;
}
.container{ position:relative; z-index:1; }

/* ─── OUT OF STOCK ─── */
.product.out-of-stock{
  opacity:0.6;
  pointer-events:auto;
}
.product.out-of-stock .video-wrapper::after{
  content:'';
  position:absolute; inset:0;
  background:rgba(0,0,0,0.45);
  border-radius:16px;
  z-index:2;
}
.oos-badge{
  position:absolute; top:10px; left:10px; z-index:3;
  display:flex; align-items:center; gap:5px;
  background:rgba(220,38,38,0.85);
  backdrop-filter:blur(6px);
  border:1px solid rgba(255,80,80,0.5);
  border-radius:20px; padding:4px 10px;
  font-family:'DM Sans',sans-serif; font-size:10px;
  font-weight:700; letter-spacing:1.2px; text-transform:uppercase;
  color:#fff;
}
.oos-badge::before{ content:'✕'; font-size:9px; }
.product.out-of-stock .price-pill{
  opacity:0.35; text-decoration:line-through;
}
.btn-oos{
  display:flex; align-items:center; justify-content:center; gap:7px;
  padding:13px; border-radius:16px; font-family:'DM Sans',sans-serif;
  font-weight:600; font-size:14px; flex:1;
  background:rgba(255,255,255,0.05);
  border:1px solid rgba(255,255,255,0.1);
  color:rgba(255,255,255,0.25);
  cursor:not-allowed;
  letter-spacing:0.3px;
}
.cat-section.grid-2 .btn-oos{
  font-size:11px; padding:10px 4px; gap:3px; border-radius:12px; letter-spacing:0;
}

/* ─── CUSTOM CURSOR — desktop only ─── */
@media(hover:hover) and (pointer:fine){
  *{ cursor:none !important; }
  .cursor{
    position:fixed; z-index:9999; pointer-events:none;
    width:10px; height:10px; border-radius:50%;
    background:var(--green);
    transform:translate(-50%,-50%);
    transition:width 0.2s ease, height 0.2s ease, opacity 0.2s ease;
    mix-blend-mode:difference;
  }
  .cursor-ring{
    position:fixed; z-index:9998; pointer-events:none;
    width:34px; height:34px; border-radius:50%;
    border:1px solid rgba(0,232,122,0.55);
    transform:translate(-50%,-50%);
    transition:width 0.25s ease, height 0.25s ease, opacity 0.25s ease;
  }
  .cursor.hovering{ width:6px; height:6px; opacity:0.7; }
  .cursor-ring.hovering{ width:46px; height:46px; border-color:rgba(0,232,122,0.3); }
}
/* Hide cursor elements on touch */
@media(hover:none){
  .cursor, .cursor-ring{ display:none !important; }
}

/* ─── SHIMMER ON PRODUCT CARDS ─── */
.product{
  position:relative;
  overflow:hidden;
}
.product::before{
  content:'';
  position:absolute; top:0; left:0;
  width:100%; height:100%;
  background:linear-gradient(
    105deg,
    transparent 0%,
    transparent 30%,
    rgba(255,255,255,0.03) 42%,
    rgba(255,255,255,0.08) 50%,
    rgba(255,255,255,0.03) 58%,
    transparent 70%,
    transparent 100%
  );
  transform:translateX(-100%) skewX(-12deg) translateZ(0);
  will-change:transform;
  transition:transform 0s;
  pointer-events:none;
  z-index:1;
}
.product:hover::before,
.product.shimmer-play::before{
  transform:translateX(100%) skewX(-12deg) translateZ(0);
  transition:transform 1.1s cubic-bezier(0.4, 0, 0.2, 1);
}

/* ─── RIPPLE ON BUTTONS ─── */
.buy-btn{ overflow:hidden; }
.ripple{
  position:absolute; border-radius:50%;
  background:rgba(255,255,255,0.3);
  transform:scale(0);
  animation:ripple-anim 0.65s ease-out;
  pointer-events:none;
}
@keyframes ripple-anim{
  to{ transform:scale(5); opacity:0; }
}

/* ─── SCROLL PROGRESS ─── */
.scroll-progress{
  position:fixed; top:0; left:0; right:0;
  height:2px; z-index:200;
  background:linear-gradient(90deg, var(--green), rgba(0,232,122,0.3));
  transform-origin:left;
  transform:scaleX(0);
  transition:transform 0.1s linear;
}

/* ─── HERO PARTICLES ─── */
.hero-particles{
  position:absolute; inset:0; z-index:2; pointer-events:none; overflow:hidden;
}
.particle{
  position:absolute; border-radius:50%;
  background:rgba(0,232,122,0.7);
  animation:particle-float linear infinite;
}
@keyframes particle-float{
  0%{ transform:translateY(0) translateX(0) scale(1); opacity:0; }
  10%{ opacity:1; }
  90%{ opacity:0.6; }
  100%{ transform:translateY(-120px) translateX(var(--drift)) scale(0.4); opacity:0; }
}

/* ─── NAV ACTIVE STATE ─── */
.cat-tab.nav-active-cali  { background:rgba(0,232,122,0.15);   border-color:rgba(0,232,122,0.5);   color:var(--cali); }
.cat-tab.nav-active-frozen{ background:rgba(100,216,255,0.15); border-color:rgba(100,216,255,0.5); color:var(--frozen); }
.cat-tab.nav-active-static{ background:rgba(255,107,53,0.15);  border-color:rgba(255,107,53,0.5);  color:var(--static); }
.cat-tab.nav-active-anon  { background:rgba(179,136,255,0.15); border-color:rgba(179,136,255,0.5); color:var(--anon); }
.cat-tab.nav-active-olive { background:rgba(212,168,67,0.15);  border-color:rgba(212,168,67,0.5);  color:var(--olive); }
.cat-tab.nav-active-info  { background:rgba(255,255,255,0.1);  border-color:rgba(255,255,255,0.25); color:var(--text); }
.cat-tab.active-festive{ background:rgba(255,200,80,0.12); border-color:rgba(255,200,80,0.35); color:#ffbf47; }



#admin-btn {
  display: block; text-align: center;
  padding: 16px;
  font-family: 'DM Sans', sans-serif;
  font-size: 10px; font-weight: 600;
  letter-spacing: 2px; text-transform: uppercase;
  color: rgba(255,255,255,0.12);
  cursor: pointer;
  -webkit-tap-highlight-color: transparent;
  user-select: none;
}


/* ─── ADMIN PANEL ─── */
#ADMIN {
  display: none;
  position: fixed; inset: 0; z-index: 1000;
  flex-direction: column;
  background: #0d1a14;
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
  font-family: 'DM Sans', sans-serif;
  color: #f0f0f0;
}
#ADMIN * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

:root{
  --bg:#0d1a14; --sur:rgba(255,255,255,0.04); --sur2:rgba(255,255,255,0.07);
  --bdr:rgba(255,255,255,0.08); --g:#00e87a; --gdim:rgba(0,232,122,0.08);
  --txt:#f0f0f0; --dim:rgba(255,255,255,0.42); --red:#ff4545; --gold:#ffd200;
  --blue:#64d8ff; --pur:#b388ff;
}
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent;}
body{font-family:'DM Sans',sans-serif;background:var(--bg);color:var(--txt);min-height:100vh;
  background-image:radial-gradient(ellipse 150% 60% at 20% -5%,rgba(0,232,122,0.1),transparent 60%),
    radial-gradient(ellipse 130% 70% at 85% 110%,rgba(0,100,255,0.12),transparent 65%);}

/* ── LOGIN ── */
#LS{position:fixed;inset:0;z-index:999;display:flex;flex-direction:column;align-items:center;
  justify-content:center;gap:18px;background:var(--bg);padding:24px;}
.ll{font-family:'Syne',sans-serif;font-weight:800;font-size:30px;color:#fff;
  letter-spacing:-1px;display:flex;align-items:baseline;gap:4px;}
.ll span{font-size:46px;letter-spacing:-2px;background:linear-gradient(135deg,#fff 30%,var(--g));
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;}
.lsub{font-size:10px;letter-spacing:3px;text-transform:uppercase;color:var(--g);}
.li{width:100%;max-width:280px;background:rgba(255,255,255,0.06);border:1px solid var(--bdr);
  border-radius:14px;padding:14px 18px;font-family:'DM Sans',sans-serif;font-size:15px;
  color:#fff;outline:none;letter-spacing:3px;transition:border-color .2s;text-align:center;}
.li:focus{border-color:rgba(0,232,122,.4);}
.lb{width:100%;max-width:280px;background:linear-gradient(135deg,var(--g),#00b85e);border:none;
  border-radius:14px;padding:14px;font-family:'DM Sans',sans-serif;font-weight:700;font-size:15px;
  color:#0d1a14;cursor:pointer;box-shadow:0 4px 20px rgba(0,232,122,.25);transition:transform .15s;}
.lb:active{transform:scale(.97);}
.lerr{font-size:12px;color:var(--red);opacity:0;transition:opacity .2s;}
.lerr.on{opacity:1;}
#LS.gone{display:none;}

/* ── HEADER ── */
.hdr{position:sticky;top:0;z-index:100;background:rgba(13,26,20,.92);backdrop-filter:blur(20px);
  border-bottom:1px solid var(--bdr);padding:12px 16px;display:flex;align-items:center;justify-content:space-between;}
.hl{font-family:'Syne',sans-serif;font-weight:800;font-size:17px;display:flex;align-items:baseline;gap:3px;}
.hl span{color:var(--g);font-size:21px;}
.hbadge{font-size:9px;letter-spacing:1.5px;text-transform:uppercase;color:var(--g);
  background:var(--gdim);border:1px solid rgba(0,232,122,.2);padding:3px 9px;border-radius:20px;}
.hquit{font-size:11px;color:var(--dim);background:none;border:1px solid var(--bdr);
  padding:5px 10px;border-radius:10px;cursor:pointer;}

/* ── TABS ── */
.tabs{display:flex;gap:6px;padding:10px 16px;overflow-x:auto;scrollbar-width:none;
  border-bottom:1px solid var(--bdr);}
.tabs::-webkit-scrollbar{display:none;}
.tb{flex-shrink:0;font-family:'DM Sans',sans-serif;font-size:11px;font-weight:600;
  padding:6px 12px;border-radius:20px;cursor:pointer;border:1px solid var(--bdr);
  background:var(--sur);color:var(--dim);transition:all .2s;white-space:nowrap;}
.tb.on{background:var(--gdim);border-color:rgba(0,232,122,.35);color:var(--g);}

/* ── BODY ── */
.body{padding:14px 16px;max-width:640px;margin:0 auto;padding-bottom:110px;}
.pane{display:none;} .pane.on{display:block;}

/* ── GENERIC ── */
.slb{font-size:9px;letter-spacing:2.5px;text-transform:uppercase;color:var(--dim);margin:16px 0 8px;font-weight:600;}
.card{background:var(--sur);border:1px solid var(--bdr);border-radius:18px;padding:16px;margin-bottom:10px;}
.card-title{font-family:'Syne',sans-serif;font-size:15px;font-weight:700;margin-bottom:14px;}
.fl{font-size:10px;letter-spacing:1px;text-transform:uppercase;color:var(--dim);margin-bottom:4px;font-weight:600;}
.fi{width:100%;background:rgba(255,255,255,.04);border:1px solid var(--bdr);border-radius:10px;
  padding:10px 12px;font-family:'DM Sans',sans-serif;font-size:13px;color:var(--txt);outline:none;transition:border-color .2s;}
.fi:focus{border-color:rgba(0,232,122,.35);}
textarea.fi{resize:none;min-height:60px;line-height:1.5;}
.fsel{appearance:none;background:rgba(255,255,255,.04);border:1px solid var(--bdr);border-radius:10px;
  padding:10px 12px;font-family:'DM Sans',sans-serif;font-size:13px;color:var(--txt);width:100%;cursor:pointer;}
.fg{margin-bottom:10px;}

/* ── STATS ── */
.stats{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;margin-bottom:16px;}
.stat{background:var(--sur);border:1px solid var(--bdr);border-radius:14px;padding:12px;text-align:center;}
.sn{font-family:'Syne',sans-serif;font-size:26px;font-weight:800;}
.sl{font-size:10px;color:var(--dim);margin-top:2px;}
.sg .sn{color:var(--g);} .sr .sn{color:var(--red);} .so .sn{color:var(--gold);}

/* ── PRODUCT CARD ── */
.pc{background:var(--sur);border:1px solid var(--bdr);border-radius:18px;margin-bottom:10px;overflow:hidden;}
.pc.oos{border-color:rgba(255,69,69,.3);}
.pc.promo{border-color:rgba(255,210,0,.25);}
.pch{display:flex;align-items:center;padding:12px 14px;gap:10px;cursor:pointer;}
.pci{flex:1;min-width:0;}
.pcn{font-family:'Syne',sans-serif;font-size:15px;font-weight:700;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
.pc.oos .pcn{text-decoration:line-through;color:var(--dim);}
.pcbg{display:flex;gap:4px;margin-top:5px;flex-wrap:wrap;}
.bge{font-size:9px;padding:2px 7px;border-radius:10px;font-weight:600;letter-spacing:.5px;}
.boos{background:rgba(255,69,69,.1);border:1px solid rgba(255,69,69,.25);color:var(--red);}
.bnew{background:rgba(0,232,122,.08);border:1px solid rgba(0,232,122,.2);color:var(--g);}
.bhid{background:rgba(255,255,255,.05);border:1px solid rgba(255,255,255,.1);color:var(--dim);}
.bpro{background:rgba(255,210,0,.1);border:1px solid rgba(255,210,0,.25);color:var(--gold);}
.pca{display:flex;gap:6px;}
.ib{width:32px;height:32px;border-radius:9px;border:1px solid var(--bdr);background:var(--sur2);
  display:flex;align-items:center;justify-content:center;cursor:pointer;font-size:14px;transition:all .15s;}
.ib:active{transform:scale(.9);}
.ib.e:hover{background:rgba(0,232,122,.12);border-color:rgba(0,232,122,.3);}
.ib.d:hover{background:rgba(255,69,69,.12);border-color:rgba(255,69,69,.3);}

/* ── EDIT PANEL ── */
.pce{display:none;padding:0 14px 14px;border-top:1px solid var(--bdr);flex-direction:column;gap:10px;}
.pce.on{display:flex;}

/* ── PRICES ── */
.prl{display:flex;flex-direction:column;gap:6px;}
.pr{display:flex;gap:6px;align-items:center;}
.pr .fi{flex:1;font-size:12px;padding:8px 10px;}
.pdel{width:28px;height:28px;border-radius:8px;background:rgba(255,69,69,.08);
  border:1px solid rgba(255,69,69,.15);color:var(--red);font-size:14px;cursor:pointer;
  display:flex;align-items:center;justify-content:center;flex-shrink:0;}
.apb{font-size:12px;color:var(--g);background:var(--gdim);border:1px dashed rgba(0,232,122,.3);
  border-radius:10px;padding:8px;width:100%;cursor:pointer;font-family:'DM Sans',sans-serif;margin-top:6px;}

/* ── TOGGLE ── */
.trow{display:flex;gap:12px;flex-wrap:wrap;}
.ti{display:flex;align-items:center;gap:8px;cursor:pointer;}
.ti input{display:none;}
.tt{width:40px;height:22px;border-radius:11px;background:rgba(255,255,255,.08);
  border:1px solid var(--bdr);position:relative;transition:all .25s;}
.th{position:absolute;top:2px;left:2px;width:16px;height:16px;border-radius:50%;
  background:rgba(255,255,255,.4);transition:all .25s;}
.ti input:checked+.tt{background:var(--gdim);border-color:rgba(0,232,122,.4);}
.ti input:checked+.tt .th{transform:translateX(18px);background:var(--g);}
.ti.tr input:checked+.tt{background:rgba(255,69,69,.12);border-color:rgba(255,69,69,.35);}
.ti.tr input:checked+.tt .th{background:var(--red);}
.ti.to input:checked+.tt{background:rgba(255,210,0,.12);border-color:rgba(255,210,0,.35);}
.ti.to input:checked+.tt .th{background:var(--gold);}
.ti.tb input:checked+.tt{background:rgba(100,216,255,.12);border-color:rgba(100,216,255,.35);}
.ti.tb input:checked+.tt .th{background:var(--blue);}
.tl{font-size:12px;color:var(--dim);}

/* ── QUICK ACTIONS ── */
.qa-grid{display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-bottom:12px;}
.qa{padding:14px 10px;border-radius:14px;border:1px solid var(--bdr);background:var(--sur2);
  font-family:'DM Sans',sans-serif;font-size:12px;font-weight:600;cursor:pointer;
  text-align:center;line-height:1.4;transition:all .2s;color:var(--txt);}
.qa:active{transform:scale(.96);}
.qa.qr{border-color:rgba(255,69,69,.25);background:rgba(255,69,69,.07);color:var(--red);}
.qa.qg{border-color:rgba(0,232,122,.25);background:var(--gdim);color:var(--g);}
.qa.qo{border-color:rgba(255,210,0,.25);background:rgba(255,210,0,.07);color:var(--gold);}
.qa.qb{border-color:rgba(100,216,255,.25);background:rgba(100,216,255,.07);color:var(--blue);}

/* ── PROMO ── */
.promo-row{display:flex;gap:8px;align-items:center;background:var(--sur2);border:1px solid var(--bdr);
  border-radius:12px;padding:10px 12px;margin-bottom:8px;}
.promo-info{flex:1;}
.promo-name{font-size:13px;font-weight:600;}
.promo-sub{font-size:11px;color:var(--dim);margin-top:2px;}
.promo-del{width:28px;height:28px;border-radius:8px;background:rgba(255,69,69,.08);
  border:1px solid rgba(255,69,69,.15);color:var(--red);font-size:13px;cursor:pointer;
  display:flex;align-items:center;justify-content:center;}

/* ── PAYMENT TAGS ── */
.pay-grid{display:flex;flex-wrap:wrap;gap:8px;margin-bottom:12px;}
.pay-tag{padding:8px 14px;border-radius:20px;border:1px solid var(--bdr);background:var(--sur);
  font-size:12px;cursor:pointer;transition:all .2s;color:var(--dim);}
.pay-tag.on{background:var(--gdim);border-color:rgba(0,232,122,.35);color:var(--g);}

/* ── ADD PRODUCT ── */
.addsec{background:var(--sur);border:2px dashed rgba(0,232,122,.2);border-radius:18px;padding:16px;}
.add-title{font-family:'Syne',sans-serif;font-weight:700;font-size:16px;margin-bottom:14px;color:var(--g);}
.abtn{background:linear-gradient(135deg,var(--g),#00b85e);border:none;border-radius:14px;padding:13px;
  font-family:'DM Sans',sans-serif;font-weight:700;font-size:14px;color:#0d1a14;cursor:pointer;
  width:100%;margin-top:4px;transition:transform .15s;}
.abtn:active{transform:scale(.97);}

/* ── GREEN BTN ── */
.gbtn{background:linear-gradient(135deg,var(--g),#00b85e);border:none;border-radius:12px;padding:11px;
  font-family:'DM Sans',sans-serif;font-weight:700;font-size:13px;color:#0d1a14;cursor:pointer;width:100%;}
.gbtn:active{transform:scale(.97);}

/* ── DANGER ── */
.dbtn{background:rgba(255,69,69,.1);border:1px solid rgba(255,69,69,.25);color:var(--red);
  font-family:'DM Sans',sans-serif;font-size:13px;font-weight:600;padding:10px 16px;
  border-radius:12px;cursor:pointer;width:100%;margin-top:8px;}

/* ── MAINTENANCE BADGE ── */
.maint-banner{background:rgba(255,69,69,.08);border:1px solid rgba(255,69,69,.2);border-radius:14px;
  padding:12px 14px;margin-bottom:12px;display:none;font-size:12px;color:var(--red);text-align:center;}
.maint-banner.on{display:block;}

/* ── GLOBAL SAVE ── */
.gsave{position:sticky;bottom:0;left:0;right:0;z-index:200;background:rgba(13,26,20,.97);
  backdrop-filter:blur(16px);-webkit-backdrop-filter:blur(16px);border-top:1px solid var(--bdr);
  padding:12px 16px;padding-bottom:max(12px,env(safe-area-inset-bottom));}
.gsbtn{width:100%;background:linear-gradient(135deg,var(--g),#00b85e);border:none;border-radius:14px;
  padding:14px;font-family:'DM Sans',sans-serif;font-weight:700;font-size:15px;color:#0d1a14;
  cursor:pointer;box-shadow:0 4px 20px rgba(0,232,122,.3);}
.dot{display:inline-block;width:7px;height:7px;background:var(--gold);border-radius:50%;
  margin-left:6px;animation:blink 1.2s ease-in-out infinite;}
@keyframes blink{0%,100%{opacity:1}50%{opacity:.3}}

/* ── TOAST ── */
.toast{position:fixed;bottom:80px;left:50%;transform:translateX(-50%) translateY(20px);
  background:rgba(0,232,122,.15);border:1px solid rgba(0,232,122,.3);backdrop-filter:blur(12px);
  border-radius:12px;padding:10px 20px;font-size:13px;font-weight:600;color:var(--g);
  opacity:0;transition:all .3s;z-index:999;white-space:nowrap;pointer-events:none;}
.toast.on{opacity:1;transform:translateX(-50%) translateY(0);}

/* ── MODAL ── */
.mo{position:fixed;inset:0;background:rgba(0,0,0,.75);z-index:500;display:none;
  align-items:center;justify-content:center;padding:20px;}
.mo.on{display:flex;}
.mb{background:#0d2018;border:1px solid var(--bdr);border-radius:20px;padding:24px;
  width:100%;max-width:320px;text-align:center;}
.mt{font-family:'Syne',sans-serif;font-size:18px;font-weight:800;margin-bottom:8px;}
.mx{font-size:13px;color:var(--dim);margin-bottom:20px;line-height:1.5;}
.mbs{display:flex;gap:10px;}
.mcan{flex:1;padding:12px;border-radius:12px;background:var(--sur);border:1px solid var(--bdr);
  color:var(--txt);font-family:'DM Sans',sans-serif;font-size:14px;cursor:pointer;}
.mcon{flex:1;padding:12px;border-radius:12px;background:rgba(255,69,69,.15);
  border:1px solid rgba(255,69,69,.3);color:var(--red);font-family:'DM Sans',sans-serif;
  font-size:14px;font-weight:700;cursor:pointer;}

/* ── HORAIRES ── */
.horaires-grid{display:grid;grid-template-columns:1fr 1fr;gap:6px;}
.h-row{display:flex;flex-direction:column;gap:4px;}
.h-day{font-size:10px;color:var(--dim);letter-spacing:.5px;}
.h-inp{font-size:12px;padding:7px 10px;}

/* ── ZONES ── */
.zone-row{display:flex;gap:8px;align-items:center;background:var(--sur2);border:1px solid var(--bdr);
  border-radius:12px;padding:9px 12px;margin-bottom:7px;}
.zone-name{flex:1;font-size:13px;}
.zone-del{width:26px;height:26px;border-radius:8px;background:rgba(255,69,69,.08);
  border:1px solid rgba(255,69,69,.15);color:var(--red);font-size:12px;cursor:pointer;
  display:flex;align-items:center;justify-content:center;}
.addzone{font-size:12px;color:var(--g);background:var(--gdim);border:1px dashed rgba(0,232,122,.3);
  border-radius:10px;padding:8px;width:100%;cursor:pointer;font-family:'DM Sans',sans-serif;margin-top:4px;}

/* ── TICKER PREVIEW ── */
.ticker-preview{background:rgba(0,232,122,.05);border:1px solid rgba(0,232,122,.15);
  border-radius:10px;padding:8px 12px;font-size:11px;color:var(--g);margin-top:6px;
  white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}

/* ── NOTIF ── */
.notif-row{display:flex;align-items:center;justify-content:space-between;
  background:var(--sur2);border:1px solid var(--bdr);border-radius:12px;padding:10px 14px;margin-bottom:8px;}
.notif-name{font-size:13px;font-weight:600;}
.notif-time{font-size:10px;color:var(--dim);margin-top:2px;}
.notif-wa{padding:7px 12px;border-radius:10px;background:rgba(37,211,102,.15);
  border:1px solid rgba(37,211,102,.25);color:#25d366;font-size:11px;font-weight:600;cursor:pointer;
  text-decoration:none;display:flex;align-items:center;gap:5px;}


/* ─── Admin trigger ─── */
#admin-trigger {
  display: block; text-align: center; padding: 20px 16px 8px;
  font-family: 'DM Sans', sans-serif; font-size: 10px; font-weight: 600;
  letter-spacing: 2px; text-transform: uppercase;
  color: rgba(255,255,255,0.12); cursor: pointer;
  -webkit-tap-highlight-color: transparent; user-select: none;
}


/* ─── iOS: prevent zoom on input focus ─── */
@media screen and (-webkit-min-device-pixel-ratio:0){
  select:focus, textarea:focus, input:focus { font-size:16px !important; }
}
/* ─── Prevent layout shift on admin open/close ─── */
html { overflow-x:hidden; }
</style>
</head>
<body>

<!-- SPLASH -->
<div id="splash">
  <canvas id="splashCanvas" style="position:absolute;inset:0;width:100%;height:100%;z-index:0;pointer-events:none;"></canvas>
  <div style="position:relative;z-index:1;display:flex;flex-direction:column;align-items:center;gap:16px;">
    <div class="splash-logo">
      <span class="splash-logo-text">DerBeste</span>
      <span class="splash-logo-num">37</span>
    </div>
    <div class="splash-sub">Tours · Since 2020</div>
    <div class="splash-bar-wrap"><div class="splash-bar"></div></div>
  </div>
</div>

<!-- BACK TO TOP -->
<button id="backTop" onclick="window.scrollTo({top:0,behavior:'smooth'})">
  <svg viewBox="0 0 24 24"><polyline points="18 15 12 9 6 15"/></svg>
</button>

<!-- BG CANVAS -->
<canvas id="bgCanvas"></canvas>

<!-- CURSOR -->
<div class="cursor" id="cursor"></div>
<div class="cursor-ring" id="cursorRing"></div>

<!-- SCROLL PROGRESS -->
<div class="scroll-progress" id="scrollProgress"></div>

<!-- HERO -->
<div class="hero">
  <img src="https://res.cloudinary.com/dsygea1px/image/upload/d_1_b4emwc.png" alt="DerBeste37" onload="this.classList.add('loaded')">
  <div class="hero-grain"></div>
  <div class="hero-particles" id="heroParticles"></div>
  <div class="hero-overlay">
    <div class="hero-badge" id="hero-badge">⭐ Since 2020</div>
    <h1><span class="hero-derbeste">DerBeste</span><span class="hero-num">37</span></h1>
    
  </div>
</div>

<!-- TICKER -->
<div class="ticker-wrap" id="ticker-wrap">
  <div class="ticker">
    <span class="ticker-item">🛵 Livraison 37 · 49 · 86 · 36 · 41 · 72</span>
    <span class="ticker-item">&nbsp;·&nbsp;</span>
    <span class="ticker-item">🤝 Meet-up Tours 37000</span>
    <span class="ticker-item">&nbsp;·&nbsp;</span>
    <span class="ticker-item">⭐ Numéro 1 depuis 2020</span>
    <span class="ticker-item">&nbsp;·&nbsp;</span>
    <span class="ticker-item">🔒 100% Discret</span>
    <span class="ticker-item">&nbsp;·&nbsp;</span>
    <span class="ticker-item">Qualité Premium sélectionnée</span>
    <span class="ticker-item">&nbsp;·&nbsp;</span>
    <span class="ticker-item">🛵 Livraison 37 · 49 · 86 · 36 · 41 · 72</span>
    <span class="ticker-item">&nbsp;·&nbsp;</span>
    <span class="ticker-item">🤝 Meet-up Tours 37000</span>
    <span class="ticker-item">&nbsp;·&nbsp;</span>
    <span class="ticker-item">⭐ Numéro 1 depuis 2020</span>
    <span class="ticker-item">&nbsp;·&nbsp;</span>
    <span class="ticker-item">🔒 100% Discret</span>
    <span class="ticker-item">&nbsp;·&nbsp;</span>
    <span class="ticker-item">Qualité Premium sélectionnée</span>
    <span class="ticker-item">&nbsp;·&nbsp;</span>
  </div>
</div>

<!-- COMMANDE NOTICE -->
<div style="
  background:rgba(37,211,102,0.08);
  border-top:1px solid rgba(37,211,102,0.15);
  border-bottom:1px solid rgba(37,211,102,0.15);
  padding:10px 18px;
  display:flex; align-items:center; gap:10px;
  font-family:'DM Sans',sans-serif; font-size:12px;
  color:rgba(255,255,255,0.75); letter-spacing:0.3px;
">
  <span style="font-size:16px;">💬</span>
  <span>Les commandes se prennent <strong style="color:#25d366;">uniquement sur WhatsApp</strong> pour le moment.</span>
</div>

<!-- CATEGORY NAV -->
<nav class="cat-nav" id="catNav">
  <div class="cat-nav-inner">
    <button class="cat-tab active-cali"  onclick="scrollToSection('sec-cali')">🌴 Cali</button>
    <button class="cat-tab active-frozen" onclick="scrollToSection('sec-frozen')">❄️ Frozen</button>
    <button class="cat-tab active-static" onclick="scrollToSection('sec-static')">⚡ Static</button>
    <button class="cat-tab active-anon"  onclick="scrollToSection('sec-anon')">🏴‍☠️ Anonymuz</button>
    <button class="cat-tab active-olive" onclick="scrollToSection('sec-olive')">🫒 Olive</button>
    <button class="cat-tab active-festive" onclick="scrollToSection('sec-festif')">💎 Pure 96%</button>
    <button class="cat-tab" onclick="scrollToSection('sec-info')" style="margin-left:auto;">ℹ️ Info</button>
  </div>
</nav>

<div class="container">

  <!-- ══════════════════════════════
       🌿 CALI HOLLANDAISE — 4 items
  ══════════════════════════════ -->
  <div class="cat-section section-cali grid-2 reveal" id="sec-cali">
    <div class="cat-header">
      <div class="cat-icon">🌴</div>
      <div class="cat-header-text">
        <div class="cat-label">Catégorie</div>
        <div class="cat-name">Cali Hollandaise</div>
        <div class="cat-sub">4 sélections premium — Qualité top niveau</div>
      </div>
    </div>

    <div class="products-grid">
    <!-- Produit 1 — Gelato -->
    <div class="product cali-card reveal" data-pid="gelato">
      <div class="video-wrapper">
        <iframe src="https://player.cloudinary.com/embed/?cloud_name=dsygea1px&public_id=gelato_tkpg56" allow="autoplay; fullscreen; encrypted-media; picture-in-picture" allowfullscreen frameborder="0"></iframe>
      </div>
      <div class="product-header">
        <h3>Gelato 🌈</h3>
        <span class="product-tag tag-cali">🌴 Cali Hollandaise</span>
      </div>
      <p>Saveurs douces et fruitées, notes de vanille.</p>
      <div class="price">
        <span class="price-pill cali-pill">2.5G / 40€</span>
        <span class="price-pill cali-pill">5G / 60€</span>
        <span class="price-pill cali-pill">10G / 100€</span>
      </div>
      <div class="btn-row">
        <a class="buy-btn whatsapp" href="https://wa.me/33758464533?text=Bonjour%2C%20je%20souhaite%20commander%20%3A%0A%F0%9F%93%A6%20Produit%20%3A%20Gelato%20%F0%9F%8C%88%0A%E2%9A%96%EF%B8%8F%20Grammage%20%3A%0A%F0%9F%92%B0%20Prix%20%3A%0A%F0%9F%95%90%20Heure%20souhait%C3%A9e%20%3A">💬 WhatsApp</a>
      </div>
    </div>

    <!-- Produit 2 — Runtz -->
    <div class="product cali-card out-of-stock reveal" data-pid="runtz">
      <div class="video-wrapper">
        <iframe src="https://player.cloudinary.com/embed/?cloud_name=dsygea1px&public_id=runtz_hnzuyh" allow="autoplay; fullscreen; encrypted-media; picture-in-picture" allowfullscreen frameborder="0"></iframe>
        <div class="oos-badge">Rupture</div>
      </div>
      <div class="product-header">
        <h3>Runtz 🍍</h3>
        <span class="product-tag tag-cali">🌴 Cali Hollandaise</span>
      </div>
      <p>Saveurs d'agrumes, notes de bonbons.</p>
      <div class="price">
        <span class="price-pill cali-pill">2.5G / 40€</span>
        <span class="price-pill cali-pill">5G / 60€</span>
        <span class="price-pill cali-pill">10G / 100€</span>
      </div>
      <div class="btn-row">
        <div class="btn-oos">❌ Indisponible</div>
      </div>
    </div>

    <!-- Produit 3 — Tropicanozz -->
    <div class="product cali-card reveal" data-pid="tropi">
      <div class="video-wrapper">
        <iframe src="https://player.cloudinary.com/embed/?cloud_name=dsygea1px&public_id=tropi_gchm6a" allow="autoplay; fullscreen; encrypted-media; picture-in-picture" allowfullscreen frameborder="0"></iframe>
      </div>
      <div class="product-header">
        <h3>Tropicanozz 🍹</h3>
        <span class="product-tag tag-cali">🌴 Cali Hollandaise</span>
      </div>
      <p>Notes exotiques d'ananas et d'agrumes.</p>
      <div class="price">
        <span class="price-pill cali-pill">2.5G / 40€</span>
        <span class="price-pill cali-pill">5G / 60€</span>
        <span class="price-pill cali-pill">10G / 100€</span>
      </div>
      <div class="btn-row">
        <a class="buy-btn whatsapp" href="https://wa.me/33758464533?text=Bonjour%2C%20je%20souhaite%20commander%20%3A%0A%F0%9F%93%A6%20Produit%20%3A%20Tropicanozz%0A%E2%9A%96%EF%B8%8F%20Grammage%20%3A%0A%F0%9F%92%B0%20Prix%20%3A%0A%F0%9F%95%90%20Heure%20souhait%C3%A9e%20%3A">💬 WhatsApp</a>
      </div>
    </div>

    <!-- Produit 4 — GMO -->
    <div class="product cali-card reveal" data-pid="gmo">
      <div class="video-wrapper">
        <iframe src="https://player.cloudinary.com/embed/?cloud_name=dsygea1px&public_id=gmo_wedtc2" allow="autoplay; fullscreen; encrypted-media; picture-in-picture" allowfullscreen frameborder="0"></iframe>
      </div>
      <div class="product-header">
        <h3>GMO 🥞</h3>
        <span class="product-tag tag-cali">🌴 Cali Hollandaise</span>
      </div>
      <p>Goût unique et puissant.</p>
      <div class="price">
        <span class="price-pill cali-pill">2.5G / 40€</span>
        <span class="price-pill cali-pill">5G / 60€</span>
        <span class="price-pill cali-pill">10G / 100€</span>
      </div>
      <div class="btn-row">
        <a class="buy-btn whatsapp" href="https://wa.me/33758464533?text=Bonjour%2C%20je%20souhaite%20commander%20%3A%0A%F0%9F%93%A6%20Produit%20%3A%20GMO%0A%E2%9A%96%EF%B8%8F%20Grammage%20%3A%0A%F0%9F%92%B0%20Prix%20%3A%0A%F0%9F%95%90%20Heure%20souhait%C3%A9e%20%3A">💬 WhatsApp</a>
      </div>
    </div>
    </div><!-- /products-grid -->
  </div>

  <!-- ══════════════════════════════
       ❄️ FROZEN — 2 items
  ══════════════════════════════ -->
  <div class="cat-section section-frozen grid-2 reveal" id="sec-frozen">
    <div class="cat-header">
      <div class="cat-icon">❄️</div>
      <div class="cat-header-text">
        <div class="cat-label">Catégorie</div>
        <div class="cat-name">Frozen</div>
        <div class="cat-sub">Sift Alec 220/90 🧨 — Meilleur rapport qualité/prix</div>
      </div>
    </div>

    <div class="products-grid">
    <!-- Produit 5 — Pannacotta -->
    <div class="product frozen-card reveal" data-pid="pannacotta">
      <div class="video-wrapper">
        <div class="video-placeholder">
          <span>☄️</span>
          <p>Vidéo à venir — Pannacotta</p>
        </div>
      </div>
      <div class="product-header">
        <h3>Pannacotta ☄️</h3>
        <div style="display:flex;gap:5px;flex-direction:column;align-items:flex-end">
          <span class="product-tag tag-frozen">❄️ Frozen Sift</span>
          <span class="product-tag tag-new">✨ Nouveauté</span>
        </div>
      </div>
      <p>Frozen Sift Alec 220/90. Arôme de vanille, notes sucrées.</p>
      <div class="price">
        <span class="price-pill frozen-pill">2G / 30€</span>
        <span class="price-pill frozen-pill">5G / 70€</span>
        <span class="price-pill frozen-pill">10G / 120€</span>
      </div>
      <div class="btn-row">
        <a class="buy-btn whatsapp" href="https://wa.me/33758464533?text=Bonjour%2C%20je%20souhaite%20commander%20%3A%0A%F0%9F%93%A6%20Produit%20%3A%20Pannacotta%20%E2%98%84%EF%B8%8F%0A%E2%9A%96%EF%B8%8F%20Grammage%20%3A%0A%F0%9F%92%B0%20Prix%20%3A%0A%F0%9F%95%90%20Heure%20souhait%C3%A9e%20%3A">💬 WhatsApp</a>
      </div>
    </div>

    <!-- Produit 6 — Lemon Lobster -->
    <div class="product frozen-card reveal" data-pid="lobster">
      <div class="video-wrapper">
        <div class="video-placeholder">
          <span>🪐</span>
          <p>Vidéo à venir — Lemon Lobster</p>
        </div>
      </div>
      <div class="product-header">
        <h3>Lemon Lobster 🪐</h3>
        <div style="display:flex;gap:5px;flex-direction:column;align-items:flex-end">
          <span class="product-tag tag-frozen">❄️ Frozen Sift</span>
          <span class="product-tag tag-new">✨ Nouveauté</span>
        </div>
      </div>
      <p>Frozen Sift Alec 220/90. Arôme de citron et d'agrumes, notes épicées.</p>
      <div class="price">
        <span class="price-pill frozen-pill">2G / 30€</span>
        <span class="price-pill frozen-pill">5G / 70€</span>
        <span class="price-pill frozen-pill">10G / 120€</span>
      </div>
      <div class="btn-row">
        <a class="buy-btn whatsapp" href="https://wa.me/33758464533?text=Bonjour%2C%20je%20souhaite%20commander%20%3A%0A%F0%9F%93%A6%20Produit%20%3A%20Lemon%20Lobster%20%F0%9F%AA%90%0A%E2%9A%96%EF%B8%8F%20Grammage%20%3A%0A%F0%9F%92%B0%20Prix%20%3A%0A%F0%9F%95%90%20Heure%20souhait%C3%A9e%20%3A">💬 WhatsApp</a>
      </div>
    </div>
    </div><!-- /products-grid -->
  </div>

  <!-- ══════════════════════════════
       ⚡ STATIC PREMIUM
  ══════════════════════════════ -->
  <div class="cat-section section-static reveal" id="sec-static">
    <div class="cat-header">
      <div class="cat-icon">⚡</div>
      <div class="cat-header-text">
        <div class="cat-label">Catégorie</div>
        <div class="cat-name">Static Premium</div>
        <div class="cat-sub">4 références — dont 3 issues de top farm</div>
      </div>
    </div>

    <div class="product static-card reveal" data-pid="plata">
      <div class="video-wrapper">
        <div class="video-placeholder">
          <span>🚀</span>
          <p>Vidéo à venir — Plata O' Plomo</p>
        </div>
      </div>
      <div class="product-header">
        <h3>Plata O' Plomo 🚀</h3>
        <div style="display:flex;gap:5px;flex-direction:column;align-items:flex-end">
          <span class="product-tag tag-static">⚡ Static Premium</span>
          <span class="product-tag tag-new">✨ Nouveauté</span>
        </div>
      </div>
      <p>Gaz Boof 💣 — Plata O' Plomo Farm. Puissance brute.</p>
      <div class="price">
        <span class="price-pill static-pill">2G / 50€</span>
        <span class="price-pill static-pill">5G / 110€</span>
        <span class="price-pill static-pill">10G / 200€</span>
      </div>
      <div class="btn-row">
        <a class="buy-btn whatsapp" href="https://wa.me/33758464533?text=Bonjour%2C%20je%20souhaite%20commander%20%3A%0A%F0%9F%93%A6%20Produit%20%3A%20Plata%20O'%20Plomo%20%F0%9F%9A%80%0A%E2%9A%96%EF%B8%8F%20Grammage%20%3A%0A%F0%9F%92%B0%20Prix%20%3A%0A%F0%9F%95%90%20Heure%20souhait%C3%A9e%20%3A">💬 WhatsApp</a>
      </div>
    </div>
  </div>

  <!-- ══════════════════════════════
       🏴‍☠️ ANONYMOUZ FARM 2026
  ══════════════════════════════ -->
  <div class="cat-section section-anon reveal" id="sec-anon">
    <div class="cat-header">
      <div class="cat-icon">🏴‍☠️</div>
      <div class="cat-header-text">
        <div class="cat-label">Top Farm Exclusive</div>
        <div class="cat-name">Anonymuz Farm</div>
        <div class="cat-sub">Static Sift 2026 — Sélection d'élite</div>
      </div>
    </div>

    <div class="top-farm-banner">
      <span>🏆</span>
      <div>
        <div>Top Farm 2026</div>
        <p>Les 3 références issues de la meilleure farm de la saison</p>
      </div>
    </div>

    <div class="product anon-card reveal" data-pid="anon">
      <div class="video-wrapper">
        <iframe src="https://player.cloudinary.com/embed/?cloud_name=dsygea1px&public_id=ano_u1eyxc" allow="autoplay; fullscreen; encrypted-media; picture-in-picture" allowfullscreen frameborder="0"></iframe>
      </div>

      <div class="product-header" style="margin-bottom:14px;">
        <h3>Static Sift 2026</h3>
        <div style="display:flex;gap:5px;flex-direction:column;align-items:flex-end">
          <span class="product-tag tag-anon">🏴‍☠️ Anonymuz</span>
          <span class="product-tag tag-top">🏆 Top Farm</span>
        </div>
      </div>

      <div class="anon-strains">
        <div class="anon-strain-item">
          <div class="anon-strain-name">Weeding Cake 🎂</div>
          <div class="anon-strain-desc">Sucré, fruité, terreux. Notes de menthe et d'épices poivrées.</div>
        </div>
        <div class="anon-strain-item">
          <div class="anon-strain-name">Gelato 41 🍭</div>
          <div class="anon-strain-desc">Vanille, crème, touches de lavande.</div>
        </div>
        <div class="anon-strain-item">
          <div class="anon-strain-name">Ice Cream 🍨</div>
          <div class="anon-strain-desc">Arôme sucré de glace à la crème.</div>
        </div>
      </div>

      <div class="price" style="margin-top:14px;">
        <span class="price-pill anon-pill">1.5G / 40€</span>
        <span class="price-pill anon-pill">5G / 120€</span>
        <span class="price-pill anon-pill">10G / 200€</span>
      </div>
      <div class="btn-row">
        <a class="buy-btn whatsapp" href="https://wa.me/33758464533?text=Bonjour%2C%20je%20souhaite%20commander%20%3A%0A%F0%9F%93%A6%20Produit%20%3A%20Anonymuz%20Farm%20Static%20Sift%0A%F0%9F%8C%BF%20Strain%20%3A%0A%E2%9A%96%EF%B8%8F%20Grammage%20%3A%0A%F0%9F%92%B0%20Prix%20%3A%0A%F0%9F%95%90%20Heure%20souhait%C3%A9e%20%3A">💬 WhatsApp</a>
      </div>
    </div>
  </div>

  <!-- ══════════════════════════════
       🫒 OLIVE
  ══════════════════════════════ -->
  <div class="cat-section section-olive reveal" id="sec-olive">
    <div class="cat-header">
      <div class="cat-icon">🫒</div>
      <div class="cat-header-text">
        <div class="cat-label">Catégorie</div>
        <div class="cat-name">Olive</div>
        <div class="cat-sub">Exclusivité Hubba Bubbatz Farm — 3 références</div>
      </div>
    </div>

    <div class="hubba-banner reveal">
      <div class="hubba-banner-glow"></div>
      <div class="hubba-banner-inner">
        <div class="hubba-icon">🫒</div>
        <div class="hubba-text">
          <div class="hubba-title">Hubba Bubbatz Farm</div>
          <div class="hubba-sub">Les 3 sélections Olive issues de la même farm d'exception</div>
        </div>
        <div class="hubba-badge">Farm Exclu</div>
      </div>
      <div class="hubba-strains">
        <span>👺 Sultan Static</span>
        <span>🍊 Tangie</span>
        <span>🍋 Lemon Ice</span>
      </div>
    </div>

    <div class="product olive-card reveal" data-pid="sultan">
      <div class="video-wrapper">
        <iframe src="https://player.cloudinary.com/embed/?cloud_name=dsygea1px&public_id=sultan_mshkhn" allow="autoplay; fullscreen; encrypted-media; picture-in-picture" allowfullscreen frameborder="0"></iframe>
      </div>
      <div class="product-header">
        <h3>Sultan Static 👺</h3>
        <div style="display:flex;gap:5px;flex-direction:column;align-items:flex-end">
          <span class="product-tag tag-olive">🫒 Olive</span>
          <span class="product-tag tag-hubba">💥 Static</span>
        </div>
      </div>
      <p>Drop Cherry 🍒 — Hubba Bubbatz Farm. Static puissant aux notes cerise profondes. Finition cristalline.</p>
      <div class="price">
        <span class="price-pill olive-pill">5G / 120€</span>
        <span class="price-pill olive-pill">10G / 200€</span>
      </div>
      <div class="btn-row">
        <a class="buy-btn whatsapp" href="https://wa.me/33758464533?text=Bonjour%2C%20je%20souhaite%20commander%20%3A%0A%F0%9F%93%A6%20Produit%20%3A%20Sultan%20Static%20%F0%9F%91%BA%20(Olive%20%7C%20Hubba%20Bubbatz%20Farm)%0A%E2%9A%96%EF%B8%8F%20Grammage%20%3A%0A%F0%9F%92%B0%20Prix%20%3A%0A%F0%9F%95%90%20Heure%20souhait%C3%A9e%20%3A">💬 WhatsApp</a>
      </div>
    </div>

    <div class="product olive-card reveal" data-pid="tangie">
      <div class="video-wrapper">
        <iframe src="https://player.cloudinary.com/embed/?cloud_name=dsygea1px&public_id=tangie_fresh_fro_bwh1jv" allow="autoplay; fullscreen; encrypted-media; picture-in-picture" allowfullscreen frameborder="0"></iframe>
      </div>
      <div class="product-header">
        <h3>Tangie 🍊</h3>
        <div style="display:flex;gap:5px;flex-direction:column;align-items:flex-end">
          <span class="product-tag tag-olive">🫒 Olive</span>
          <span class="product-tag tag-frozen">❄️ Fresh Frozen</span>
        </div>
      </div>
      <p>Fresh Frozen — Hubba Bubbatz Farm. Notes d'agrumes, orange vive et fraîche. Finition irréprochable.</p>
      <div class="price">
        <span class="price-pill olive-pill">5G / 100€</span>
        <span class="price-pill olive-pill">10G / 160€</span>
      </div>
      <div class="btn-row">
        <a class="buy-btn whatsapp" href="https://wa.me/33758464533?text=Bonjour%2C%20je%20souhaite%20commander%20%3A%0A%F0%9F%93%A6%20Produit%20%3A%20Tangie%20%F0%9F%8D%91%20Fresh%20Frozen%20(Olive%20%7C%20Hubba%20Bubbatz%20Farm)%0A%E2%9A%96%EF%B8%8F%20Grammage%20%3A%0A%F0%9F%92%B0%20Prix%20%3A%0A%F0%9F%95%90%20Heure%20souhait%C3%A9e%20%3A">💬 WhatsApp</a>
      </div>
    </div>

    <div class="product olive-card reveal" data-pid="lemon_ice">
      <div class="video-wrapper">
        <iframe src="https://player.cloudinary.com/embed/?cloud_name=dsygea1px&public_id=lemon_ice_k5aatd" allow="autoplay; fullscreen; encrypted-media; picture-in-picture" allowfullscreen frameborder="0"></iframe>
      </div>
      <div class="product-header">
        <h3>Lemon Ice 🍋</h3>
        <div style="display:flex;gap:5px;flex-direction:column;align-items:flex-end">
          <span class="product-tag tag-olive">🫒 Olive</span>
          <span class="product-tag tag-hubba">💥 Static</span>
        </div>
      </div>
      <p>Static — Hubba Bubbatz Farm. Citron glacé, puissance et fraîcheur réunies.</p>
      <div class="price">
        <span class="price-pill olive-pill">5G / 100€</span>
        <span class="price-pill olive-pill">10G / 160€</span>
      </div>
      <div class="btn-row">
        <a class="buy-btn whatsapp" href="https://wa.me/33758464533?text=Bonjour%2C%20je%20souhaite%20commander%20%3A%0A%F0%9F%93%A6%20Produit%20%3A%20Lemon%20Ice%20%F0%9F%8D%8B%20Static%20(Olive%20%7C%20Hubba%20Bubbatz%20Farm)%0A%E2%9A%96%EF%B8%8F%20Grammage%20%3A%0A%F0%9F%92%B0%20Prix%20%3A%0A%F0%9F%95%90%20Heure%20souhait%C3%A9e%20%3A">💬 WhatsApp</a>
      </div>
    </div>
  </div>

  <!-- ══════════════════════════════
       💎 PURE 96%
  ══════════════════════════════ -->
  <div class="festive-section reveal" id="sec-festif">
    <div class="section-title" style="color:#ffbf47;">Pure 96%</div>

    <div class="festive-teaser">
      <div class="festive-teaser-strip">❄️ &nbsp; Pure 96% — Écaille</div>
      <div class="festive-teaser-body">
        <div class="festive-placeholder">
          <div class="festive-placeholder-inner">
            <span class="big-emoji">❄️</span>
            <span class="label">Vidéo à venir</span>
            <span class="sublabel">Bientôt disponible</span>
          </div>
        </div>
        <div class="festive-info-row">
          <div class="festive-name">Écaille ❄️</div>
          <span class="tag-festive">💎 Pure 96%</span>
        </div>
        <p class="festive-desc">La pureté à l'état brut. 96% — Sélection d'exception réservée aux connaisseurs.</p>
        <div class="price" style="margin-bottom:14px;">
          <span class="price-pill" style="border-color:rgba(255,200,80,0.25);color:#ffbf47;">0.5G / 30€</span>
          <span class="price-pill" style="border-color:rgba(255,200,80,0.25);color:#ffbf47;">1G / 50€</span>
          <span class="price-pill" style="border-color:rgba(255,200,80,0.25);color:#ffbf47;">5G / 240€</span>
          <span class="price-pill" style="border-color:rgba(255,200,80,0.25);color:#ffbf47;">10G / 460€</span>
        </div>
        <div class="btn-row">
          <a class="buy-btn whatsapp" href="https://wa.me/33758464533?text=Bonjour%2C%20je%20souhaite%20commander%20%3A%0A%F0%9F%93%A6%20Produit%20%3A%20%C3%89caille%20%E2%9D%84%EF%B8%8F%20(Pure%2096%25)%0A%E2%9A%96%EF%B8%8F%20Grammage%20%3A%0A%F0%9F%92%B0%20Prix%20%3A%0A%F0%9F%95%90%20Heure%20souhait%C3%A9e%20%3A">💬 WhatsApp</a>
        </div>
      </div>
    </div>
  </div>

  <!-- POURQUOI NOUS -->
  <div class="section-title reveal">Pourquoi nous</div>
  <div class="why-grid">
    <div class="why-card reveal"><span class="why-icon">⭐</span><div class="why-label">Since<br>2020</div></div>
    <div class="why-card reveal"><span class="why-icon">🛵</span><div class="why-label">Livraison<br>Express</div></div>
    <div class="why-card reveal"><span class="why-icon">🔒</span><div class="why-label">100%<br>Discret</div></div>
    <div class="why-card reveal"><span class="why-icon">🥇</span><div class="why-label">Sélection<br>Top Farm</div></div>
    <div class="why-card reveal"><span class="why-icon">💬</span><div class="why-label">Réponse<br>rapide</div></div>
    <div class="why-card reveal"><span class="why-icon">📍</span><div class="why-label">Tours<br>& région</div></div>
  </div>

  <!-- INFO -->
  <div class="section-title reveal" style="margin-top:8px;" id="sec-info">Info</div>

  <div class="info-header reveal">
    <div class="info-name">Der Beste Coffee</div>
    <div class="info-sub">Numéro 🥇 dans le 37000 · Since 2020 👌</div>
  </div>

  <div class="info-row reveal">
    <div class="info-block">
      <span class="block-icon">🤝</span>
      <div class="block-title">Meet-up</div>
      <div class="block-text" id="meetup-zones">Tours 37000</div>
    </div>
    <div class="info-block">
      <span class="block-icon">🛵</span>
      <div class="block-title">Livraison</div>
      <div class="block-text" id="livraison-zones">37 · 49 · 86<br>36 · 41 · 72</div>
    </div>
  </div>

  <div class="info-block reveal" style="margin-bottom:10px; border-color:rgba(0,232,122,0.2);">
    <span class="block-icon">🛵</span>
    <div class="block-title">Minimum de commande</div>
    <div class="block-text" id="min-livr-text" style="color:var(--green); font-size:15px;">50€ <span style="font-size:12px; color:var(--text-dim); font-weight:400;">en livraison</span></div>
    <div id="min-detail-text" style="font-size:11px; color:var(--text-dim); margin-top:6px; font-weight:300; line-height:1.6;">Meet-up sans minimum · Livraison à partir de 50€</div>
  </div>

  <div class="horaires-box reveal" id="horaires-box">
    <div class="block-title">🕐 &nbsp;Horaires</div>
    <div id="horaires-rows">
      <div class="horaire-row">
        <span class="horaire-day">Lundi — Vendredi</span>
        <span class="horaire-time">11h00 – 23h00</span>
      </div>
      <div class="horaire-row">
        <span class="horaire-day">Samedi — Dimanche</span>
        <span class="horaire-time">12h00 – 00h00</span>
      </div>
    </div>
  </div>

  <div class="produits-box reveal">
    <div class="block-title">Nos produits</div>
    <div class="produits-grid">
      <span class="produit-tag">🌴 Cali / Hollandaise</span>
      <span class="produit-tag">❄️ Fresh Frozen</span>
      <span class="produit-tag">⚡ Static Premium</span>
      <span class="produit-tag">🫒 Olive</span>
      <span class="produit-tag">🍫 Hash Premium</span>
      <span class="produit-tag">🫧 Top Mousse</span>
      <span class="produit-tag">❄️ Écaille</span>
    </div>
    <div style="width:100%;height:1px;background:rgba(255,255,255,0.07);margin:10px 0;"></div>
    <div class="produits-grid">
      <span class="produit-tag flag-tag">🇲🇦</span>
      <span class="produit-tag flag-tag">🇳🇱</span>
      <span class="produit-tag flag-tag">🇺🇸</span>
    </div>
  </div>

  <!-- CONTACT -->
  <div class="section-title reveal" style="margin-top:24px;">Contact</div>

  <a class="contact-item reveal" id="contact-tg-link" href="https://t.me/DerBeste37" style="border-color:rgba(42,171,238,0.2);">
    <div class="contact-icon-wrap tg">🛠️</div>
    <div>
      <div class="contact-label" style="color:rgba(42,171,238,0.7);">SAV — Service client</div>
      <div class="contact-value" id="contact-tg-handle">@DerBeste37</div>
    </div>
  </a>

  <div class="footer reveal">
    <div class="footer-line"></div>
    <div class="footer-text">© 2026 DerBeste37</div>
  </div>

</div>

<script>
// ─── Splash screen with orbs ───
(function(){
  const sc = document.getElementById('splashCanvas');
  if(!sc) return;
  const ctx = sc.getContext('2d');
  sc.width = window.innerWidth; sc.height = window.innerHeight;
  const orbs = [
    {x:sc.width*.2, y:sc.height*.3, r:200, vx:.5, vy:.4, c:'0,232,122',   a:.25},
    {x:sc.width*.8, y:sc.height*.6, r:180, vx:-.4,vy:.5, c:'179,136,255', a:.22},
    {x:sc.width*.5, y:sc.height*.8, r:220, vx:.4, vy:-.4,c:'255,210,0',   a:.18},
  ];
  function drawSplash(){
    ctx.clearRect(0,0,sc.width,sc.height);
    orbs.forEach(o=>{
      o.x+=o.vx; o.y+=o.vy;
      if(o.x<-o.r)o.x=sc.width+o.r; if(o.x>sc.width+o.r)o.x=-o.r;
      if(o.y<-o.r)o.y=sc.height+o.r; if(o.y>sc.height+o.r)o.y=-o.r;
      ctx.filter='blur(50px)';
      const g=ctx.createRadialGradient(o.x,o.y,0,o.x,o.y,o.r);
      g.addColorStop(0,`rgba(${o.c},${o.a})`);
      g.addColorStop(0.5,`rgba(${o.c},${o.a*.4})`);
      g.addColorStop(1,`rgba(${o.c},0)`);
      ctx.fillStyle=g; ctx.beginPath(); ctx.arc(o.x,o.y,o.r,0,Math.PI*2); ctx.fill();
      ctx.filter='none';
    });
    requestAnimationFrame(drawSplash);
  }
  drawSplash();
})();

window.addEventListener('DOMContentLoaded', () => {
  const splash = document.getElementById('splash');
  setTimeout(() => {
    splash.classList.add('hide');
    setTimeout(() => splash.remove(), 700);
  }, 2200);
});

// ─── Back to top visibility ───
window.addEventListener('scroll', () => {
  const btn = document.getElementById('backTop');
  if(btn) btn.classList.toggle('visible', window.scrollY > 300);
}, { passive:true });

// ─── Sync from Admin Panel ───
(function(){
  async function _doApply(){
    try {
    const [sp, ss] = await Promise.allSettled([
      window.Store.get('admin-products'),
      window.Store.get('admin-settings')
    ]);

    if(ss.status==='fulfilled' && ss.value){
      const S = JSON.parse(ss.value.value);

      if(S.maintenance){
        const overlay = document.createElement('div');
        overlay.style.cssText = 'position:fixed;inset:0;z-index:9999;background:#0d1a14;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:16px;padding:32px;';
        overlay.innerHTML = `
          <div style="font-family:'Syne',sans-serif;font-size:40px;font-weight:800;color:#fff;letter-spacing:-2px;">DerBeste<span style="color:#00e87a;">37</span></div>
          <div style="font-size:28px;">🔐</div>
          <div style="font-size:15px;color:rgba(255,255,255,.6);text-align:center;max-width:280px;line-height:1.6;">${S.maintMsg||'Boutique temporairement fermée. Revenez bientôt 🙏'}</div>
        `;
        document.body.appendChild(overlay);
        return;
      }

      if(S.tickerOn && S.ticker){
        const tw = document.getElementById('ticker-wrap');
        if(tw){
          const tDiv = tw.querySelector('.ticker');
          if(tDiv){
            const sep = '<span class="ticker-item">&nbsp;·&nbsp;</span>';
            tDiv.innerHTML = `<span class="ticker-item">${S.ticker}</span>${sep}`.repeat(4);
          }
        }
      }

      if(S.heroBadge !== undefined){
        const hb = document.getElementById('hero-badge');
        if(hb && S.heroBadge) hb.textContent = S.heroBadge;
      }

      if(S.minLivr !== undefined){
        const ml = document.getElementById('min-livr-text');
        if(ml) ml.innerHTML = `${S.minLivr}€ <span style="font-size:12px;color:var(--text-dim);font-weight:400;">en livraison</span>`;
        const md = document.getElementById('min-detail-text');
        const meetTxt = (S.minMeet && S.minMeet > 0) ? `Meet-up à partir de ${S.minMeet}€` : 'Meet-up sans minimum';
        if(md) md.textContent = `${meetTxt} · Livraison à partir de ${S.minLivr}€`;
      }

      if(S.horaires){
        const rowsEl = document.getElementById('horaires-rows');
        if(rowsEl){
          const days = ['Lun','Mar','Mer','Jeu','Ven','Sam','Dim'];
          const dayNames = {Lun:'Lundi',Mar:'Mardi',Mer:'Mercredi',Jeu:'Jeudi',Ven:'Vendredi',Sam:'Samedi',Dim:'Dimanche'};
          rowsEl.innerHTML = days.map(d => {
            const time = S.horaires[d] || 'Fermé';
            return `<div class="horaire-row"><span class="horaire-day">${dayNames[d]}</span><span class="horaire-time">${time}</span></div>`;
          }).join('');
        }
      }

      if(S.horaireMsg){
        const hb2 = document.getElementById('horaires-box');
        if(hb2){
          const existing = hb2.querySelector('.horaire-msg');
          if(!existing){
            const msg = document.createElement('div');
            msg.className = 'horaire-msg';
            msg.style.cssText = 'font-size:12px;color:var(--text-dim);margin-top:8px;line-height:1.5;';
            msg.textContent = S.horaireMsg;
            hb2.appendChild(msg);
          } else { existing.textContent = S.horaireMsg; }
        }
      }

      if(S.paiements && S.paiements.length){
        const hb2 = document.getElementById('horaires-box');
        if(hb2 && !document.getElementById('pay-methods')){
          const div = document.createElement('div');
          div.id = 'pay-methods';
          div.style.cssText = 'margin-top:12px;padding-top:10px;border-top:1px solid rgba(255,255,255,.06);';
          div.innerHTML = `<div style="font-size:10px;letter-spacing:2px;text-transform:uppercase;color:var(--text-dim);margin-bottom:8px;font-weight:600;">Paiement accepté</div>
            <div style="display:flex;flex-wrap:wrap;gap:6px;">${S.paiements.map(p=>`<span style="font-size:11px;padding:4px 10px;border-radius:20px;background:rgba(0,232,122,.08);border:1px solid rgba(0,232,122,.15);color:#00e87a;">${p}</span>`).join('')}</div>`;
          hb2.appendChild(div);
        }
      }

      if(S.zones && S.zones.length){
        const livrEl = document.getElementById('livraison-zones');
        if(livrEl) livrEl.innerHTML = S.zones.slice(0,6).join('<br>');
        const meetEl = document.getElementById('meetup-zones');
        if(meetEl && S.zones[0]) meetEl.textContent = S.zones[0];
      }

      if(S.whatsapp){
        document.querySelectorAll('a[href*="wa.me"]').forEach(a=>{
          a.href = a.href.replace(/wa\.me\/\d+/, `wa.me/${S.whatsapp}`);
        });
      }

      if(S.telegram){
        const tgHandle = S.telegram.replace(/^@/, '');
        const tgDisplay = S.telegram.startsWith('@') ? S.telegram : '@' + S.telegram;
        document.querySelectorAll('a[href*="t.me"]').forEach(a=>{
          a.href = `https://t.me/${tgHandle}`;
        });
        const tgTxt = document.getElementById('contact-tg-handle');
        if(tgTxt) tgTxt.textContent = tgDisplay;
      }

      if(S.minMeet !== undefined){
        const mmEl = document.getElementById('min-meet-text');
        if(mmEl) mmEl.textContent = S.minMeet === 0 ? 'Sans minimum' : `${S.minMeet}€ minimum`;
      }
    }

    if(sp.status!=='fulfilled' || !sp.value) return;
    const products = JSON.parse(sp.value.value);
    const wa = (() => { try{ return JSON.parse((ss.status==='fulfilled'&&ss.value)?ss.value.value:'{}').whatsapp||'33758464533'; }catch(e){return'33758464533';} })();

    document.querySelectorAll('[data-pid]').forEach(card => {
      const pid = card.dataset.pid;
      const p = products.find(x => x.id === pid);
      if(!p) return;

      if(p.hidden){ card.style.display='none'; return; }

      const btnRow = card.querySelector('.btn-row');
      const wasOos = card.classList.contains('out-of-stock');
      if(p.oos && !wasOos){
        card.classList.add('out-of-stock');
        const vw = card.querySelector('.video-wrapper');
        if(vw && !vw.querySelector('.oos-badge')){
          const badge = document.createElement('div');
          badge.className = 'oos-badge'; badge.textContent = '✕ Rupture';
          vw.appendChild(badge);
          const overlay = document.createElement('div');
          overlay.style.cssText = 'position:absolute;inset:0;background:rgba(0,0,0,0.5);border-radius:16px;z-index:2;';
          vw.insertBefore(overlay, vw.firstChild);
        }
        if(btnRow) btnRow.innerHTML = '<div class="btn-oos">❌ Indisponible</div>';
      } else if(!p.oos && wasOos){
        card.classList.remove('out-of-stock');
        const vw = card.querySelector('.video-wrapper');
        if(vw){
          vw.querySelector('.oos-badge')?.remove();
          vw.querySelector('div[style*="rgba(0,0,0,0.5)"]')?.remove();
        }
        if(btnRow){
          const name = card.querySelector('h3')?.textContent || '';
          const tpl = (()=>{ try{ return JSON.parse((ss.status==='fulfilled'&&ss.value)?ss.value.value:'{}').waTpl||null; }catch(e){return null;} })();
          const msg = tpl
            ? encodeURIComponent(tpl.replace('{produit}',name).replace('{grammage}','').replace('{prix}',''))
            : encodeURIComponent(`Bonjour, je souhaite commander :\n📦 Produit : ${name}\n⚖️ Grammage :\n💰 Prix :\n🕐 Heure souhaitée :`);
          btnRow.innerHTML = `<a class="buy-btn whatsapp" href="https://wa.me/${wa}?text=${msg}">💬 WhatsApp</a>`;
        }
      }

      if(p.name){ const h3 = card.querySelector('h3'); if(h3) h3.textContent = p.name; }

      if(p.desc){
        const desc = card.querySelector('p:not(.video-placeholder p)');
        if(desc && !desc.closest('.video-placeholder')) desc.textContent = p.desc;
      }

      const header = card.querySelector('.product-header');
      const existingNew = card.querySelector('.tag-new');
      if(p.isNew && !existingNew && header){
        const wrap = header.querySelector('div[style]') || header;
        const span = document.createElement('span');
        span.className = 'product-tag tag-new'; span.textContent = '✨ Nouveauté';
        wrap.appendChild(span);
      } else if(!p.isNew && existingNew){ existingNew.remove(); }

      const existingPromo = card.querySelector('.tag-promo');
      if(p.promo && !existingPromo && header){
        const wrap = header.querySelector('div[style]') || header;
        const span = document.createElement('span');
        span.className = 'product-tag tag-promo';
        span.style.cssText = 'background:rgba(255,210,0,.1);border:1px solid rgba(255,210,0,.3);color:#ffd200;';
        span.textContent = '🏷️ ' + p.promo;
        wrap.appendChild(span);
      } else if(!p.promo && existingPromo){ existingPromo.remove(); }

      if(p.prices && p.prices.length){
        const priceEl = card.querySelector('.price');
        if(priceEl){
          const cls = priceEl.querySelector('.price-pill')?.className || 'price-pill';
          priceEl.innerHTML = p.prices.map(pr=>`<span class="${cls}">${pr}</span>`).join('');
        }
      }

      if(p.video){
        const vw = card.querySelector('.video-wrapper');
        if(vw && !vw.querySelector('iframe')){
          const placeholder = vw.querySelector('.video-placeholder');
          if(placeholder) placeholder.remove();
          const iframe = document.createElement('iframe');
          iframe.src = p.video;
          iframe.setAttribute('allow','autoplay;fullscreen;encrypted-media;picture-in-picture');
          iframe.setAttribute('allowfullscreen','');
          iframe.setAttribute('frameborder','0');
          iframe.style.cssText = 'position:absolute;top:0;left:0;width:100%;height:100%;border:0;';
          vw.appendChild(iframe);
        }
      }
    });

  } catch(e){ console.log('Admin sync error:', e); }
  }
  // Run immediately if Store ready, else wait
  if(window._storeReady){ _doApply(); }
  else { window._pendingApply = _doApply; window.addEventListener('storeReady', _doApply, {once:true}); }
})();

// ─── Telegram WebApp ───
try {
  const tg = window.Telegram.WebApp;
  tg.expand();
  tg.setBackgroundColor('#0d1a14');
  if(tg.setHeaderColor) tg.setHeaderColor('#0d1a14');
} catch(e){}

// ─── Smooth scroll ───
function scrollToSection(id) {
  const el = document.getElementById(id);
  if(!el) return;
  const offset = document.getElementById('catNav').offsetHeight + 12;
  const top = el.getBoundingClientRect().top + window.scrollY - offset;
  window.scrollTo({ top, behavior: 'smooth' });
  try{ window.Telegram.WebApp.HapticFeedback.impactOccurred('light'); }catch(e){}
}

window.addEventListener('DOMContentLoaded', () => {

  if('IntersectionObserver' in window){
    document.body.classList.add('js-ready');
    const revealObs = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if(entry.isIntersecting){
          setTimeout(() => entry.target.classList.add('visible'), 50);
          revealObs.unobserve(entry.target);
        }
      });
    }, { threshold: 0.06 });
    document.querySelectorAll('.reveal').forEach(el => revealObs.observe(el));
  }

  if('IntersectionObserver' in window){
    let lastScrollY = window.scrollY;
    window.addEventListener('scroll', () => { lastScrollY = window.scrollY; }, { passive:true });

    const shimmerObs = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if(entry.isIntersecting && lastScrollY >= (entry.target._lastScrollY || 0)){
          const card = entry.target;
          setTimeout(() => {
            card.classList.add('shimmer-play');
            setTimeout(() => card.classList.remove('shimmer-play'), 1000);
          }, 280);
          shimmerObs.unobserve(card);
        }
        entry.target._lastScrollY = lastScrollY;
      });
    }, { threshold: 0.25 });
    document.querySelectorAll('.product').forEach(p => shimmerObs.observe(p));
  }

  const vidModal    = document.getElementById('vidModal');
  const vidModalInner = document.getElementById('vidModalInner');
  const vidModalClose = document.getElementById('vidModalClose');

  function openVidModal(src){
    vidModalInner.innerHTML = `<iframe src="${src}" allow="autoplay; fullscreen; encrypted-media; picture-in-picture" allowfullscreen frameborder="0"></iframe>`;
    vidModal.classList.add('open');
    document.body.style.overflow = 'hidden';
    try{ window.Telegram.WebApp.disableClosingConfirmation(); }catch(e){}
  }
  function closeVidModal(){
    vidModal.classList.remove('open');
    vidModalInner.innerHTML = '';
    document.body.style.overflow = '';
  }

  vidModalClose.addEventListener('click', closeVidModal);
  vidModal.addEventListener('click', (e) => { if(e.target === vidModal) closeVidModal(); });
  document.addEventListener('keydown', (e) => { if(e.key === 'Escape') closeVidModal(); });

  document.querySelectorAll('.grid-2 .video-wrapper').forEach(wrapper => {
    const iframe = wrapper.querySelector('iframe');
    if(!iframe) return;
    const src = iframe.src;
    const btn = document.createElement('button');
    btn.className = 'fs-btn';
    btn.innerHTML = `<svg viewBox="0 0 24 24"><polyline points="15 3 21 3 21 9"/><polyline points="9 21 3 21 3 15"/><line x1="21" y1="3" x2="14" y2="10"/><line x1="3" y1="21" x2="10" y2="14"/></svg>`;
    btn.addEventListener('click', (e) => {
      e.stopPropagation();
      openVidModal(src);
    });
    wrapper.appendChild(btn);
  });

  const progressBar = document.getElementById('scrollProgress');
  window.addEventListener('scroll', () => {
    const scrolled = window.scrollY;
    const maxScroll = document.documentElement.scrollHeight - window.innerHeight;
    progressBar.style.transform = `scaleX(${scrolled / maxScroll})`;
  }, { passive: true });

  const sections = [
    { id:'sec-cali',   cls:'nav-active-cali' },
    { id:'sec-frozen', cls:'nav-active-frozen' },
    { id:'sec-static', cls:'nav-active-static' },
    { id:'sec-anon',   cls:'nav-active-anon' },
    { id:'sec-olive',  cls:'nav-active-olive' },
    { id:'sec-info',   cls:'nav-active-info' },
  ];
  const tabs = document.querySelectorAll('.cat-tab');
  const navH = document.getElementById('catNav').offsetHeight;

  const navObs = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if(entry.isIntersecting){
        const idx = sections.findIndex(s => s.id === entry.target.id);
        if(idx === -1) return;
        tabs.forEach((t,i) => {
          t.classList.remove('nav-active-cali','nav-active-frozen','nav-active-static','nav-active-anon','nav-active-olive','nav-active-info');
          if(i === idx) t.classList.add(sections[idx].cls);
        });
      }
    });
  }, { rootMargin: `-${navH + 10}px 0px -55% 0px`, threshold: 0 });

  sections.forEach(s => {
    const el = document.getElementById(s.id);
    if(el) navObs.observe(el);
  });

  const container = document.getElementById('heroParticles');
  if(container){
    const isMobile = window.innerWidth < 600;
    const count = isMobile ? 10 : 18;
    for(let i = 0; i < count; i++){
      const p = document.createElement('div');
      p.className = 'particle';
      const size = Math.random() * 3 + 1.5;
      p.style.cssText = `
        width:${size}px; height:${size}px;
        left:${Math.random()*100}%;
        bottom:${Math.random()*40}%;
        --drift:${(Math.random()-0.5)*40}px;
        animation-duration:${Math.random()*5 + 4}s;
        animation-delay:${Math.random()*6}s;
        opacity:0;
      `;
      container.appendChild(p);
    }
  }

  document.querySelectorAll('.product').forEach(card => {
    card.addEventListener('touchstart', () => {
      card.classList.add('lit');
      if(!card.dataset.shimmering){
        card.dataset.shimmering = '1';
        card.classList.remove('shimmer-play');
        void card.offsetWidth;
        card.classList.add('shimmer-play');
        setTimeout(() => {
          card.classList.remove('shimmer-play');
          delete card.dataset.shimmering;
        }, 1200);
      }
    }, { passive: true });
    card.addEventListener('touchend', () => {
      setTimeout(() => card.classList.remove('lit'), 450);
    }, { passive: true });
    card.addEventListener('touchcancel', () => {
      card.classList.remove('lit');
    }, { passive: true });
  });

  document.querySelectorAll('.buy-btn').forEach(btn => {
    btn.addEventListener('click', function(e){
      const r = document.createElement('span');
      r.className = 'ripple';
      const rect = this.getBoundingClientRect();
      const size = Math.max(rect.width, rect.height);
      r.style.cssText = `width:${size}px;height:${size}px;left:${e.clientX-rect.left-size/2}px;top:${e.clientY-rect.top-size/2}px;`;
      this.appendChild(r);
      setTimeout(() => r.remove(), 600);
      try{ window.Telegram.WebApp.HapticFeedback.impactOccurred('light'); }catch(e){}
    });
  });

  const cursor = document.getElementById('cursor');
  const ring   = document.getElementById('cursorRing');
  if(cursor && ring && window.matchMedia('(hover:hover)').matches){
    let mx = -100, my = -100, rx = -100, ry = -100;
    document.addEventListener('mousemove', e => { mx = e.clientX; my = e.clientY; });
    function animCursor(){
      cursor.style.left = mx+'px'; cursor.style.top = my+'px';
      rx += (mx - rx) * 0.14; ry += (my - ry) * 0.14;
      ring.style.left = rx+'px'; ring.style.top  = ry+'px';
      requestAnimationFrame(animCursor);
    }
    animCursor();
    document.querySelectorAll('a,button,.product,.why-card,.contact-item').forEach(el => {
      el.addEventListener('mouseenter', () => { cursor.classList.add('hovering'); ring.classList.add('hovering'); });
      el.addEventListener('mouseleave', () => { cursor.classList.remove('hovering'); ring.classList.remove('hovering'); });
    });
  }

});
</script>

<!-- VIDEO MODAL -->
<div class="vid-modal" id="vidModal">
  <button class="vid-modal-close" id="vidModalClose">✕</button>
  <div class="vid-modal-inner" id="vidModalInner"></div>
</div>

<script>
(function(){
  const canvas = document.getElementById('bgCanvas');
  if(!canvas) return;
  const ctx = canvas.getContext('2d');
  let W, H;

  function resize(){
    W = canvas.width  = window.innerWidth;
    H = canvas.height = window.innerHeight;
  }
  resize();
  window.addEventListener('resize', resize, {passive:true});

  const GREEN  = '0,232,122';
  const PURPLE = '179,136,255';
  const GOLD   = '255,210,0';
  const TEAL   = '200,255,80';

  const orbs = [
    {x:W*.15, y:H*.2,  r:420, vx:.06,  vy:.05,  c:GREEN,  a:.22},
    {x:W*.85, y:H*.55, r:400, vx:-.05, vy:.07,  c:PURPLE, a:.20},
    {x:W*.5,  y:H*.85, r:450, vx:.05,  vy:-.06, c:GOLD,   a:.16},
    {x:W*.1,  y:H*.7,  r:390, vx:.07,  vy:-.04, c:TEAL,   a:.18},
    {x:W*.9,  y:H*.15, r:410, vx:-.06, vy:.06,  c:GREEN,  a:.18},
  ];

  let tick = 0;

  function draw(){
    ctx.clearRect(0, 0, W, H);
    tick++;

    orbs.forEach(o => {
      o.x += o.vx; o.y += o.vy;
      if(o.x < -o.r) o.x = W+o.r; if(o.x > W+o.r) o.x = -o.r;
      if(o.y < -o.r) o.y = H+o.r; if(o.y > H+o.r) o.y = -o.r;
      ctx.filter = 'blur(55px)';
      const g = ctx.createRadialGradient(o.x,o.y,0, o.x,o.y,o.r);
      g.addColorStop(0,    `rgba(${o.c},${o.a})`);
      g.addColorStop(0.35, `rgba(${o.c},${o.a*.6})`);
      g.addColorStop(0.65, `rgba(${o.c},${o.a*.2})`);
      g.addColorStop(0.85, `rgba(${o.c},${o.a*.05})`);
      g.addColorStop(1,    `rgba(${o.c},0)`);
      ctx.fillStyle = g;
      ctx.beginPath(); ctx.arc(o.x,o.y,o.r,0,Math.PI*2); ctx.fill();
      ctx.filter = 'none';
    });

    requestAnimationFrame(draw);
  }
  draw();
})();
</script>

<!-- ─── ADMIN PANEL ─── -->
<div id="ADMIN">


<!-- LOGIN -->
<div id="LS">
  <div class="ll">DerBeste<span>37</span></div>
  <div class="lsub">🔒 Panel Admin</div>
  <input class="li" type="password" id="li" placeholder="••••••••" maxlength="30">
  <button class="lb" onclick="tryLogin()">Accéder</button>
  <div class="lerr" id="lerr">Mot de passe incorrect</div>
  <button onclick="window.closeAdminPanel()" style="margin-top:8px;background:none;border:none;font-family:'DM Sans',sans-serif;font-size:13px;font-weight:500;color:rgba(255,255,255,0.3);cursor:pointer;display:flex;align-items:center;gap:6px;-webkit-tap-highlight-color:transparent;transition:color 0.2s;" onmouseover="this.style.color='rgba(255,255,255,0.6)'" onmouseout="this.style.color='rgba(255,255,255,0.3)'">← Retour</button>
</div>

<!-- ADMIN -->
<div id="AU" style="display:none;">
  <div class="hdr">
    <div class="hl">DerBeste<span>37</span></div>
    <div style="display:flex;gap:8px;align-items:center;">
      <div class="hbadge" id="maintBadge" style="display:none;background:rgba(255,69,69,.1);border-color:rgba(255,69,69,.3);color:var(--red);">🔴 Fermé</div>
      <div class="hbadge">⚙️ Admin</div>
      <button class="hquit" onclick="window.closeAdminPanel()">Fermer</button>
    </div>
  </div>

  <div class="tabs">
    <button class="tb on" onclick="ST(this,'products')">📦 Produits</button>
    <button class="tb" onclick="ST(this,'quick')">⚡ Rapide</button>
    <button class="tb" onclick="ST(this,'add')">➕ Ajouter</button>
    <button class="tb" onclick="ST(this,'promo')">🏷️ Promos</button>
    <button class="tb" onclick="ST(this,'boutique')">🏪 Boutique</button>
    <button class="tb" onclick="ST(this,'livraison')">🛵 Livraison</button>
    <button class="tb" onclick="ST(this,'messages')">💬 Messages</button>
    <button class="tb" onclick="ST(this,'settings')">⚙️ Config</button>
  </div>

  <div class="body">

    <!-- ══ PRODUITS ══ -->
    <div class="pane on" id="p-products">
      <div class="slb" style="margin-top:6px;">Vue d'ensemble</div>
      <div class="stats">
        <div class="stat sg"><div class="sn" id="sT">0</div><div class="sl">Produits</div></div>
        <div class="stat sr"><div class="sn" id="sO">0</div><div class="sl">Ruptures</div></div>
        <div class="stat so"><div class="sn" id="sN">0</div><div class="sl">Nouveautés</div></div>
      </div>
      <div class="slb">Catalogue</div>
      <div id="PL"></div>
    </div>

    <!-- ══ ACTIONS RAPIDES ══ -->
    <div class="pane" id="p-quick">
      <div class="slb" style="margin-top:6px;">Actions rapides</div>
      <div class="qa-grid">
        <div class="qa qr" onclick="qAction('allOos')">❌<br>Tout en rupture</div>
        <div class="qa qg" onclick="qAction('allStock')">✅<br>Tout en stock</div>
        <div class="qa qo" onclick="qAction('allNew')">✨<br>Tout nouveau</div>
        <div class="qa" onclick="qAction('clearNew')">🚫<br>Retirer nouveautés</div>
        <div class="qa qb" onclick="qAction('showAll')">👁️<br>Tout afficher</div>
        <div class="qa" onclick="qAction('hideAll')">🙈<br>Tout masquer</div>
        <div class="qa qo" onclick="qAction('clearPromo')">🔖<br>Retirer promos</div>
        <div class="qa qr" onclick="confirmA('reset','','Réinitialiser le catalogue ?','Tous les produits seront remis par défaut.')">🔄<br>Réinitialiser</div>
      </div>
      <div class="slb">Par catégorie</div>
      <div id="catActions"></div>
    </div>

    <!-- ══ AJOUTER ══ -->
    <div class="pane" id="p-add">
      <div class="slb" style="margin-top:6px;">Nouveau produit</div>
      <div class="addsec">
        <div class="add-title">➕ Ajouter un produit</div>
        <div class="fg"><div class="fl">Nom du produit</div>
          <input class="fi" id="nn" placeholder="ex: Gelato 🌈" type="text"></div>
        <div class="fg"><div class="fl">Catégorie</div>
          <select class="fsel" id="nc" id="nc"></select></div>
        <div class="fg"><div class="fl">Description</div>
          <textarea class="fi" id="nd" rows="2" placeholder="Arômes, notes..."></textarea></div>
        <div class="fg"><div class="fl">URL Vidéo Cloudinary (optionnel)</div>
          <input class="fi" id="nv" placeholder="https://player.cloudinary.com/..." type="text"></div>
        <div class="fg"><div class="fl">Prix</div>
          <div id="np-list" class="prl">
            <div class="pr"><input class="fi" style="font-size:12px;padding:8px 10px;" placeholder="2.5G / 40€" type="text">
              <button class="pdel" onclick="this.closest('.pr').remove()">✕</button></div>
          </div>
          <button class="apb" onclick="addPR('np-list')">+ Ajouter un tarif</button></div>
        <div class="fg"><div class="fl">Statut</div>
          <div class="trow">
            <label class="ti"><input type="checkbox" id="ni"><div class="tt"><div class="th"></div></div><span class="tl">✨ Nouveauté</span></label>
            <label class="ti tr"><input type="checkbox" id="no"><div class="tt"><div class="th"></div></div><span class="tl">❌ Rupture</span></label>
            <label class="ti"><input type="checkbox" id="nh"><div class="tt"><div class="th"></div></div><span class="tl">🙈 Masqué</span></label>
          </div></div>
        <button class="abtn" onclick="addProduct()">✅ Ajouter au catalogue</button>
      </div>
    </div>

    <!-- ══ PROMOS ══ -->
    <div class="pane" id="p-promo">
      <div class="slb" style="margin-top:6px;">Promotions actives</div>
      <div id="promoList"><div style="font-size:13px;color:var(--dim);text-align:center;padding:20px;">Aucune promo active</div></div>
      <div class="slb">Ajouter une promo</div>
      <div class="card">
        <div class="fg"><div class="fl">Produit</div><select class="fsel" id="promo-pid"></select></div>
        <div class="fg"><div class="fl">Type</div>
          <select class="fsel" id="promo-type">
            <option value="pct">% Réduction</option>
            <option value="fixed">Prix fixe</option>
            <option value="badge">Badge promo</option>
            <option value="lot">Offre lot (ex: 3 pour 2)</option>
          </select></div>
        <div class="fg"><div class="fl">Valeur / Texte</div>
          <input class="fi" id="promo-val" placeholder="ex: -20% ou 2=1" type="text"></div>
        <button class="abtn" style="margin-top:0;" onclick="addPromo()">✅ Appliquer la promo</button>
      </div>
    </div>

    <!-- ══ BOUTIQUE ══ -->
    <div class="pane" id="p-boutique">
      <div class="slb" style="margin-top:6px;">Mode boutique</div>
      <div class="card">
        <div class="card-title">🏪 Statut de la boutique</div>
        <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:14px;">
          <div><div style="font-size:13px;font-weight:600;">Mode maintenance</div>
            <div style="font-size:11px;color:var(--dim);margin-top:3px;">Ferme la boutique aux clients</div></div>
          <label class="ti tr"><input type="checkbox" id="s-maint" onchange="toggleMaint(this.checked)">
            <div class="tt"><div class="th"></div></div></label>
        </div>
        <div class="fg"><div class="fl">Message de fermeture</div>
          <input class="fi" id="s-maintmsg" value="Boutique temporairement fermée. Revenez bientôt 🙏" type="text" oninput="markU()"></div>
      </div>

      <div class="slb">Ticker / Annonce</div>
      <div class="card">
        <div class="card-title">📢 Bandeau défilant</div>
        <div class="fg"><div class="fl">Texte du ticker</div>
          <input class="fi" id="s-ticker" placeholder="ex: 🔥 Nouvelle arrivée cette semaine..." type="text" oninput="document.getElementById('ticker-preview').textContent=this.value||'Aperçu du ticker'"></div>
        <div class="ticker-preview" id="ticker-preview">Aperçu du ticker</div>
        <div style="margin-top:12px;display:flex;gap:8px;align-items:center;">
          <label class="ti"><input type="checkbox" id="s-ticker-on"><div class="tt"><div class="th"></div></div></label>
          <span style="font-size:12px;color:var(--dim);">Activer le ticker personnalisé</span>
        </div>
      </div>

      <div class="slb">Section héro</div>
      <div class="card">
        <div class="card-title">🖼️ Badge hero</div>
        <div class="fg"><div class="fl">Texte du badge (au-dessus du titre)</div>
          <input class="fi" id="s-herobadge" placeholder="ex: ⭐ Since 2020" type="text" oninput="markU()"></div>
      </div>
    </div>

    <!-- ══ LIVRAISON ══ -->
    <div class="pane" id="p-livraison">
      <div class="slb" style="margin-top:6px;">Horaires de livraison</div>
      <div class="card">
        <div class="card-title">🕐 Plages horaires</div>
        <div class="horaires-grid" id="horaires-grid"></div>
        <div style="margin-top:12px;">
          <div class="fl">Message horaire affiché</div>
          <input class="fi" id="s-horaireMsg" placeholder="ex: Livraison 12h–22h tous les jours" type="text" oninput="markU()"></div>
      </div>

      <div class="slb">Commande minimum</div>
      <div class="card">
        <div class="fg"><div class="fl">Minimum livraison (€)</div>
          <input class="fi" id="s-minlivr" placeholder="50" type="number" oninput="markU()"></div>
        <div class="fg"><div class="fl">Minimum meet-up (€)</div>
          <input class="fi" id="s-minmeet" placeholder="0" type="number" oninput="markU()"></div>
      </div>

      <div class="slb">Zones de livraison</div>
      <div class="card">
        <div id="zones-list"></div>
        <input class="fi" id="zone-inp" placeholder="ex: Tours centre, Joué-lès-Tours..." type="text" style="margin-top:4px;">
        <button class="apb" onclick="addZone()">+ Ajouter une zone</button>
      </div>

      <div class="slb">Moyens de paiement</div>
      <div class="card">
        <div class="fl" style="margin-bottom:10px;">Sélectionne les moyens acceptés</div>
        <div class="pay-grid" id="pay-grid"></div>
      </div>
    </div>

    <!-- ══ MESSAGES ══ -->
    <div class="pane" id="p-messages">
      <div class="slb" style="margin-top:6px;">Templates WhatsApp</div>
      <div class="card">
        <div class="card-title">📋 Message de commande</div>
        <div class="fg"><div class="fl">Template (utilise {produit} {grammage} {prix})</div>
          <textarea class="fi" id="s-watpl" rows="5" oninput="markU()"></textarea></div>
        <button class="gbtn" onclick="saveWaTpl()">💾 Enregistrer le template</button>
      </div>

      <div class="slb">Message rupture de stock</div>
      <div class="card">
        <div class="card-title">❌ Message "Me prévenir"</div>
        <div class="fg"><div class="fl">Message automatique</div>
          <textarea class="fi" id="s-wanotif" rows="4" oninput="markU()"></textarea></div>
        <button class="gbtn" onclick="saveWaTpl()">💾 Enregistrer</button>
      </div>

      <div class="slb">Numéros de contact</div>
      <div class="card">
        <div class="fg"><div class="fl">Numéro WhatsApp</div>
          <input class="fi" id="s-wa" placeholder="33758464533" type="text" oninput="markU()"></div>
        <div class="fg"><div class="fl">Telegram SAV</div>
          <input class="fi" id="s-tg" placeholder="@DerBeste37" type="text" oninput="markU()"></div>
      </div>
    </div>

    <!-- ══ CONFIG ══ -->
    <div class="pane" id="p-settings">
      <div class="slb" style="margin-top:6px;">Sécurité</div>
      <div class="card">
        <div class="card-title">🔒 Mot de passe admin</div>
        <div class="fg"><div class="fl">Nouveau mot de passe</div>
          <input class="fi" id="s-np" placeholder="Nouveau" type="password"></div>
        <div class="fg"><div class="fl">Confirmer</div>
          <input class="fi" id="s-cp" placeholder="Confirmer" type="password"></div>
        <button class="gbtn" onclick="changePass()">💾 Changer</button>
      </div>

      <div class="slb">Export / Import</div>
      <div class="card">
        <div class="card-title">📦 Sauvegarde des données</div>
        <div style="display:flex;gap:8px;">
          <button class="gbtn" style="flex:1;" onclick="exportData()">⬇️ Exporter JSON</button>
          <button class="gbtn" style="flex:1;background:var(--sur2);color:var(--txt);" onclick="document.getElementById('import-inp').click()">⬆️ Importer</button>
          <input type="file" id="import-inp" accept=".json" style="display:none;" onchange="importData(this)">
        </div>
      </div>

      <div class="slb">Danger</div>
      <div class="card">
        <button class="dbtn" onclick="confirmA('reset','','Réinitialiser ?','Catalogue remis par défaut. Irréversible.')">🔄 Remettre catalogue par défaut</button>
        <button class="dbtn" onclick="confirmA('wipe','','Tout effacer ?','TOUTES les données admin seront supprimées. Irréversible.')">💣 Effacer toutes les données</button>
      </div>
    </div>

  </div>

  <div class="gsave" id="GS">
    <button class="gsbtn" onclick="saveAll()">💾 Sauvegarder les modifications</button>
  </div>
</div>

<div class="toast" id="toast"></div>
<div class="mo" id="modal">
  <div class="mb">
    <div class="mt" id="m-title">Confirmer</div>
    <div class="mx" id="m-text">Êtes-vous sûr ?</div>
    <div class="mbs">
      <button class="mcan" onclick="document.getElementById('modal').classList.remove('on')">Annuler</button>
      <button class="mcon" id="m-ok">Confirmer</button>
    </div>
  </div>
</div>



</div>

<!-- ─── Admin trigger ─── -->
<span id="admin-trigger" onclick="window.openAdminPanel()">admin</span>

<script>
// Safe console shim for Telegram WebView
(function(){
  var c = window.console = window.console || {};
  ['log','warn','info','error','debug'].forEach(function(m){
    if(typeof c[m] !== 'function') c[m] = function(){};
  });
})();

(function(){
  'use strict';


// ═══════════════════════════════════════
// DATA
// ═══════════════════════════════════════
const CATS={cali:'🌴 Cali Hollandaise',frozen:'❄️ Frozen Sift',static:'⚡ Static Premium',anon:'🏴‍☠️ Anonymuz Farm',olive:'🫒 Olive',festif:'💎 Pure 96%'};
const PAYS=['💵 Cash','📱 Lydia','💸 Virement','🪙 Crypto'];
const DAYS=['Lun','Mar','Mer','Jeu','Ven','Sam','Dim'];

const DEFS=[
  {id:'gelato',name:'Gelato 🌈',cat:'cali',desc:"Saveurs douces et fruitées, notes de vanille.",prices:['2.5G / 40€','5G / 60€','10G / 100€'],oos:false,isNew:false,hidden:false,promo:null,video:''},
  {id:'runtz',name:'Runtz 🍍',cat:'cali',desc:"Saveurs d'agrumes, notes de bonbons.",prices:['2.5G / 40€','5G / 60€','10G / 100€'],oos:true,isNew:false,hidden:false,promo:null,video:''},
  {id:'tropi',name:'Tropicanozz 🍹',cat:'cali',desc:"Notes exotiques d'ananas et d'agrumes.",prices:['2.5G / 40€','5G / 60€','10G / 100€'],oos:false,isNew:false,hidden:false,promo:null,video:''},
  {id:'gmo',name:'GMO 🧄',cat:'cali',desc:'Goût unique et puissant.',prices:['2.5G / 40€','5G / 60€','10G / 100€'],oos:false,isNew:false,hidden:false,promo:null,video:''},
  {id:'pannacotta',name:'Pannacotta ☄️',cat:'frozen',desc:'Frozen Sift Alec 220/90. Arôme de vanille, notes sucrées.',prices:['2G / 30€','5G / 70€','10G / 120€'],oos:false,isNew:true,hidden:false,promo:null,video:''},
  {id:'lobster',name:'Lemon Lobster 🪐',cat:'frozen',desc:"Frozen Sift Alec 220/90. Arôme de citron et d'agrumes.",prices:['2G / 30€','5G / 70€','10G / 120€'],oos:false,isNew:true,hidden:false,promo:null,video:''},
  {id:'plata',name:"Plata O' Plomo 🚀",cat:'static',desc:"Gaz Boof 💣 — Plata O' Plomo Farm.",prices:['2G / 35€','5G / 80€','10G / 150€'],oos:false,isNew:true,hidden:false,promo:null,video:''},
  {id:'anon',name:'Anonymuz Farm 🏴‍☠️',cat:'anon',desc:'Weeding Cake · Gelato 41 · Ice Cream',prices:['2G / 35€','5G / 80€','10G / 150€'],oos:false,isNew:false,hidden:false,promo:null,video:''},
  {id:'sultan',name:'Sultan Drop Cherry 👺',cat:'olive',desc:'Drop Cherry 🍒 — Hubba Bubbatz. Finition cristalline.',prices:['2G / 35€','5G / 80€'],oos:false,isNew:false,hidden:false,promo:null,video:''},
  {id:'tangie',name:'Tangie 🍊',cat:'olive',desc:"Fresh Frozen — Hubba Bubbatz. Notes d'agrumes, orange vive.",prices:['2G / 35€','5G / 80€'],oos:false,isNew:false,hidden:false,promo:null,video:''},
  {id:'lemon_ice',name:'Lemon Ice 🧊',cat:'olive',desc:'Lemon Ice — Hubba Bubbatz. Citron glacé, puissance.',prices:['2G / 35€','5G / 80€'],oos:false,isNew:false,hidden:false,promo:null,video:''},
  {id:'ecaille',name:'Écaille 💎',cat:'festif',desc:"La pureté à l'état brut. 96% — Sélection d'exception.",prices:['0.5G / 30€','1G / 50€','5G / 240€','10G / 460€'],oos:false,isNew:false,hidden:false,promo:null,video:''},
];

let P=[], S={
  whatsapp:'33758464533', telegram:'@DerBeste37', password:'beste37',
  maintenance:false, maintMsg:'Boutique temporairement fermée. Revenez bientôt 🙏',
  ticker:'', tickerOn:false,
  heroSub:'Tours · Since 2020', heroBadge:'⭐ Since 2020',
  horaires:{Lun:'12h–22h',Mar:'12h–22h',Mer:'12h–22h',Jeu:'12h–22h',Ven:'12h–22h',Sam:'12h–22h',Dim:'Fermé'},
  horaireMsg:'Livraison tous les jours 12h–22h',
  minLivr:50, minMeet:0,
  zones:['Tours centre','Joué-lès-Tours','Saint-Cyr-sur-Loire','La Riche'],
  paiements:[],
  waTpl:"Bonjour, je souhaite commander :\n📦 Produit : {produit}\n⚖️ Grammage : {grammage}\n💰 Prix : {prix}\n🕐 Heure souhaitée :",
  waNotif:"Bonjour ! Je souhaite être prévenu du retour en stock de :\n📦 {produit}\n\nMerci 🙏",
  promos:[]
};
let unsaved=false;

// ═══════════════════════════════════════
// LOGIN
// ═══════════════════════════════════════
function tryLogin(){
  const v=document.getElementById('li').value;
  if(v===S.password||v==='beste37'){
    document.getElementById('LS').style.display='none';
    document.getElementById('AU').style.display='block';
    adminInit();
  } else {
    const e=document.getElementById('lerr');e.classList.add('on');
    document.getElementById('li').value='';
    setTimeout(()=>e.classList.remove('on'),2000);
  }
}

// ═══════════════════════════════════════
// INIT
// ═══════════════════════════════════════
async function adminInit(){
  try{
    var Store = window.Store;
    if(!Store) throw new Error('Store not ready');
    const sp = await Store.get('admin-products');
    if(sp) P=JSON.parse(sp.value); else P=JSON.parse(JSON.stringify(DEFS));
    const ss = await Store.get('admin-settings');
    if(ss) S={...S,...JSON.parse(ss.value)};
  }catch(e){ console.log('adminInit error:', e.message); P=JSON.parse(JSON.stringify(DEFS)); }
  window.S = S; window.P = P;
  buildUI(); render();
}

function buildUI(){
  const nc=document.getElementById('nc');
  nc.innerHTML=Object.entries(CATS).map(([k,v])=>`<option value="${k}">${v}</option>`).join('');

  const hg=document.getElementById('horaires-grid');
  hg.innerHTML=DAYS.map(d=>`<div class="h-row">
    <div class="h-day">${d}</div>
    <input class="fi h-inp" id="h-${d}" value="${S.horaires[d]||'Fermé'}" type="text" oninput="window.S.horaires['${d}']=this.value;window.markU()">
  </div>`).join('');

  renderZones();

  const pg=document.getElementById('pay-grid');
  pg.innerHTML=PAYS.map(p=>`<div class="pay-tag${S.paiements.includes(p)?' on':''}" onclick="togglePay(this,'${p}')">${p}</div>`).join('');

  document.getElementById('s-watpl').value=S.waTpl;
  document.getElementById('s-wanotif').value=S.waNotif;
  document.getElementById('s-wa').value=S.whatsapp;
  document.getElementById('s-tg').value=S.telegram;
  document.getElementById('s-maint').checked=S.maintenance;
  document.getElementById('s-maintmsg').value=S.maintMsg;
  document.getElementById('s-ticker').value=S.ticker;
  document.getElementById('s-ticker-on').checked=S.tickerOn;
  document.getElementById('s-herobadge').value=S.heroBadge;
  document.getElementById('s-minlivr').value=S.minLivr;
  document.getElementById('s-minmeet').value=S.minMeet;
  document.getElementById('s-horaireMsg').value=S.horaireMsg;
  if(S.ticker) document.getElementById('ticker-preview').textContent=S.ticker;
  if(S.maintenance){document.getElementById('maintBadge').style.display='block';}

  const pp=document.getElementById('promo-pid');
  pp.innerHTML=P.map(p=>`<option value="${p.id}">${p.name}</option>`).join('');

  const ca=document.getElementById('catActions');
  ca.innerHTML=Object.entries(CATS).map(([k,v])=>`
    <div style="display:flex;gap:8px;margin-bottom:8px;align-items:center;">
      <div style="flex:1;font-size:13px;">${v}</div>
      <button class="qa qr" style="flex:0 0 auto;font-size:11px;padding:7px 10px;border-radius:10px;" onclick="catAction('${k}','oos')">❌ Rupture</button>
      <button class="qa qg" style="flex:0 0 auto;font-size:11px;padding:7px 10px;border-radius:10px;" onclick="catAction('${k}','stock')">✅ Stock</button>
    </div>`).join('');
}

function renderZones(){
  const zl=document.getElementById('zones-list');
  zl.innerHTML=S.zones.map((z,i)=>`<div class="zone-row">
    <div class="zone-name">${z}</div>
    <button class="zone-del" onclick="delZone(${i})">✕</button>
  </div>`).join('');
}

// ═══════════════════════════════════════
// TABS
// ═══════════════════════════════════════
function ST(btn,name){
  document.querySelectorAll('.pane').forEach(p=>p.classList.remove('on'));
  document.querySelectorAll('.tb').forEach(b=>b.classList.remove('on'));
  document.getElementById('p-'+name).classList.add('on');
  btn.classList.add('on');
}

// ═══════════════════════════════════════
// RENDER PRODUCTS
// ═══════════════════════════════════════
function render(){
  const list=document.getElementById('PL');
  list.innerHTML='';
  let oos=0,nw=0;
  const grp={};
  P.forEach(p=>{if(!grp[p.cat])grp[p.cat]=[];grp[p.cat].push(p);});

  Object.entries(CATS).forEach(([k,v])=>{
    const ps=grp[k];if(!ps||!ps.length)return;
    const l=document.createElement('div');l.className='slb';l.textContent=v;list.appendChild(l);
    ps.forEach(p=>{
      if(p.oos)oos++;if(p.isNew)nw++;
      const c=document.createElement('div');
      c.className='pc'+(p.oos?' oos':'')+(p.promo?' promo':'');c.id='c-'+p.id;
      c.innerHTML=`<div class="pch" onclick="TE('${p.id}')">
        <div class="pci">
          <div class="pcn">${p.name}</div>
          <div class="pcbg">
            ${p.oos?'<span class="bge boos">❌ Rupture</span>':''}
            ${p.isNew?'<span class="bge bnew">✨ Nouveau</span>':''}
            ${p.hidden?'<span class="bge bhid">🙈 Masqué</span>':''}
            ${p.promo?`<span class="bge bpro">🏷️ ${p.promo}</span>`:''}
          </div>
        </div>
        <div class="pca">
          <div class="ib e" onclick="event.stopPropagation();TE('${p.id}')">✏️</div>
          <div class="ib d" onclick="event.stopPropagation();confirmA('del','${p.id}','Supprimer ?','&quot;${p.name}&quot; sera supprimé définitivement.')">🗑️</div>
        </div></div>
      <div class="pce" id="e-${p.id}">
        <div class="fg"><div class="fl">Nom</div>
          <input class="fi" value="${p.name}" oninput="SF('${p.id}','name',this.value)" type="text"></div>
        <div class="fg"><div class="fl">Catégorie</div>
          <select class="fsel" onchange="SF('${p.id}','cat',this.value)">
            ${Object.entries(CATS).map(([ck,cv])=>`<option value="${ck}"${p.cat===ck?' selected':''}>${cv}</option>`).join('')}
          </select></div>
        <div class="fg"><div class="fl">Description</div>
          <textarea class="fi" rows="2" oninput="SF('${p.id}','desc',this.value)">${p.desc}</textarea></div>
        <div class="fg"><div class="fl">Vidéo Cloudinary URL</div>
          <input class="fi" value="${p.video||''}" oninput="SF('${p.id}','video',this.value)" placeholder="https://player.cloudinary.com/..." type="text"></div>
        <div class="fg"><div class="fl">Prix</div>
          <div class="prl" id="pr-${p.id}">
            ${p.prices.map((pr,i)=>`<div class="pr">
              <input class="fi" style="font-size:12px;padding:8px 10px;" value="${pr}" type="text" oninput="SP('${p.id}',${i},this.value)">
              <button class="pdel" onclick="DP('${p.id}',${i})">✕</button>
            </div>`).join('')}
          </div>
          <button class="apb" onclick="AP('${p.id}')">+ Tarif</button></div>
        <div class="fg"><div class="fl">Statut</div>
          <div class="trow">
            <label class="ti"><input type="checkbox" ${p.isNew?'checked':''} onchange="SF('${p.id}','isNew',this.checked)">
              <div class="tt"><div class="th"></div></div><span class="tl">✨ Nouveauté</span></label>
            <label class="ti tr"><input type="checkbox" ${p.oos?'checked':''} onchange="SF('${p.id}','oos',this.checked)">
              <div class="tt"><div class="th"></div></div><span class="tl">❌ Rupture</span></label>
            <label class="ti"><input type="checkbox" ${p.hidden?'checked':''} onchange="SF('${p.id}','hidden',this.checked)">
              <div class="tt"><div class="th"></div></div><span class="tl">🙈 Masqué</span></label>
          </div></div>
      </div>`;
      list.appendChild(c);
    });
  });

  document.getElementById('sT').textContent=P.length;
  document.getElementById('sO').textContent=oos;
  document.getElementById('sN').textContent=nw;

  const pp=document.getElementById('promo-pid');
  if(pp) pp.innerHTML=P.map(p=>`<option value="${p.id}">${p.name}</option>`).join('');

  renderPromos();
}

function TE(id){document.getElementById('e-'+id).classList.toggle('on');}

// ═══════════════════════════════════════
// FIELD UPDATES
// ═══════════════════════════════════════
function SF(id,f,v){
  const p=P.find(x=>x.id===id);if(!p)return;
  p[f]=v;markU();
  const c=document.getElementById('c-'+id);
  if(c){
    c.className='pc'+(p.oos?' oos':'')+(p.promo?' promo':'');
    c.querySelector('.pcn').textContent=p.name;
    c.querySelector('.pcbg').innerHTML=
      (p.oos?'<span class="bge boos">❌ Rupture</span>':'')+
      (p.isNew?'<span class="bge bnew">✨ Nouveau</span>':'')+
      (p.hidden?'<span class="bge bhid">🙈 Masqué</span>':'')+
      (p.promo?`<span class="bge bpro">🏷️ ${p.promo}</span>`:'');
  }
}
function SP(id,i,v){const p=P.find(x=>x.id===id);if(p){p.prices[i]=v;markU();}}
function AP(id){
  const p=P.find(x=>x.id===id);if(!p)return;
  const i=p.prices.length;p.prices.push('');
  const el=document.getElementById('pr-'+id);
  const row=document.createElement('div');row.className='pr';
  row.innerHTML=`<input class="fi" style="font-size:12px;padding:8px 10px;" value="" type="text" oninput="SP('${id}',${i},this.value)"><button class="pdel" onclick="DP('${id}',${i})">✕</button>`;
  el.appendChild(row);markU();
}
function DP(id,i){
  const p=P.find(x=>x.id===id);if(!p)return;
  p.prices.splice(i,1);render();
  document.getElementById('e-'+id).classList.add('on');markU();
}

// ═══════════════════════════════════════
// QUICK ACTIONS
// ═══════════════════════════════════════
function qAction(t){
  switch(t){
    case 'allOos':    P.forEach(p=>p.oos=true); toast('❌ Tous en rupture'); break;
    case 'allStock':  P.forEach(p=>p.oos=false); toast('✅ Tous en stock'); break;
    case 'allNew':    P.forEach(p=>p.isNew=true); toast('✨ Tous marqués nouveauté'); break;
    case 'clearNew':  P.forEach(p=>p.isNew=false); toast('🚫 Nouveautés retirées'); break;
    case 'showAll':   P.forEach(p=>p.hidden=false); toast('👁️ Tous visibles'); break;
    case 'hideAll':   P.forEach(p=>p.hidden=true); toast('🙈 Tous masqués'); break;
    case 'clearPromo':P.forEach(p=>p.promo=null); S.promos=[]; toast('🔖 Promos retirées'); break;
    case 'reset':     P=JSON.parse(JSON.stringify(DEFS)); toast('🔄 Catalogue réinitialisé'); break;
  }
  render(); markU();
}
function catAction(cat,t){
  P.filter(p=>p.cat===cat).forEach(p=>p.oos=(t==='oos'));
  toast(t==='oos'?`❌ ${CATS[cat]} — rupture`:`✅ ${CATS[cat]} — en stock`);
  render(); markU();
}

// ═══════════════════════════════════════
// ADD PRODUCT
// ═══════════════════════════════════════
function addPR(lid){
  const l=document.getElementById(lid);
  const r=document.createElement('div');r.className='pr';
  r.innerHTML=`<input class="fi" style="font-size:12px;padding:8px 10px;" placeholder="5G / 60€" type="text"><button class="pdel" onclick="this.closest('.pr').remove()">✕</button>`;
  l.appendChild(r);
}
function addProduct(){
  const name=document.getElementById('nn').value.trim();
  if(!name){toast('❌ Nom obligatoire');return;}
  const prices=Array.from(document.querySelectorAll('#np-list input')).map(i=>i.value.trim()).filter(Boolean);
  P.push({id:'p_'+Date.now(),name,cat:document.getElementById('nc').value,
    desc:document.getElementById('nd').value.trim(),
    video:document.getElementById('nv').value.trim(),
    prices,oos:document.getElementById('no').checked,
    isNew:document.getElementById('ni').checked,
    hidden:document.getElementById('nh').checked,promo:null});
  ['nn','nd','nv'].forEach(id=>document.getElementById(id).value='');
  ['ni','no','nh'].forEach(id=>document.getElementById(id).checked=false);
  document.getElementById('np-list').innerHTML='<div class="pr"><input class="fi" style="font-size:12px;padding:8px 10px;" placeholder="2.5G / 40€" type="text"><button class="pdel" onclick="this.closest(\'.pr\').remove()">✕</button></div>';
  toast('✅ Produit ajouté');markU();
  document.querySelectorAll('.tb')[0].click();render();
}

// ═══════════════════════════════════════
// PROMOS
// ═══════════════════════════════════════
function addPromo(){
  const pid=document.getElementById('promo-pid').value;
  const type=document.getElementById('promo-type').value;
  const val=document.getElementById('promo-val').value.trim();
  if(!val){toast('❌ Valeur requise');return;}
  const p=P.find(x=>x.id===pid);if(!p)return;
  const label=type==='pct'?`-${val}%`:type==='fixed'?`${val}€`:type==='lot'?val:val;
  p.promo=label;
  if(!S.promos)S.promos=[];
  S.promos=S.promos.filter(x=>x.id!==pid);
  S.promos.push({id:pid,name:p.name,type,val,label});
  document.getElementById('promo-val').value='';
  toast(`🏷️ Promo appliquée sur ${p.name}`);markU();render();
}
function removePromo(pid){
  const p=P.find(x=>x.id===pid);if(p)p.promo=null;
  S.promos=(S.promos||[]).filter(x=>x.id!==pid);
  markU();render();toast('🗑️ Promo retirée');
}
function renderPromos(){
  const pl=document.getElementById('promoList');
  const active=(S.promos||[]).filter(pr=>P.find(p=>p.id===pr.id&&p.promo));
  pl.innerHTML=active.length?active.map(pr=>`
    <div class="promo-row">
      <div class="promo-info">
        <div class="promo-name">${pr.name}</div>
        <div class="promo-sub">🏷️ ${pr.label}</div>
      </div>
      <button class="promo-del" onclick="removePromo('${pr.id}')">✕</button>
    </div>`).join(''):'<div style="font-size:13px;color:var(--dim);text-align:center;padding:20px;">Aucune promo active</div>';
}

// ═══════════════════════════════════════
// BOUTIQUE
// ═══════════════════════════════════════
function toggleMaint(v){
  S.maintenance=v;
  document.getElementById('maintBadge').style.display=v?'block':'none';
  markU();
}

// ═══════════════════════════════════════
// LIVRAISON
// ═══════════════════════════════════════
function addZone(){
  const v=document.getElementById('zone-inp').value.trim();
  if(!v){toast('❌ Zone vide');return;}
  S.zones.push(v);document.getElementById('zone-inp').value='';
  renderZones();markU();
}
function delZone(i){ S.zones.splice(i,1);renderZones();markU(); }
function togglePay(el,p){
  el.classList.toggle('on');
  if(el.classList.contains('on'))S.paiements.push(p);
  else S.paiements=S.paiements.filter(x=>x!==p);
  markU();
}

// ═══════════════════════════════════════
// MESSAGES
// ═══════════════════════════════════════
function saveWaTpl(){
  S.waTpl=document.getElementById('s-watpl').value;
  S.waNotif=document.getElementById('s-wanotif').value;
  markU();
  saveAll();
}

// ═══════════════════════════════════════
// SETTINGS
// ═══════════════════════════════════════
function changePass(){
  const np=document.getElementById('s-np').value;
  const cp=document.getElementById('s-cp').value;
  if(!np){toast('❌ Mot de passe vide');return;}
  if(np!==cp){toast('❌ Mots de passe différents');return;}
  S.password=np;
  document.getElementById('s-np').value='';
  document.getElementById('s-cp').value='';
  markU();toast('🔒 Mot de passe changé');
}

function exportData(){
  const data={products:P,settings:S,exportedAt:new Date().toISOString()};
  const blob=new Blob([JSON.stringify(data,null,2)],{type:'application/json'});
  const a=document.createElement('a');a.href=URL.createObjectURL(blob);
  a.download=`DerBeste37-backup-${new Date().toISOString().split('T')[0]}.json`;
  a.click();toast('⬇️ Export téléchargé');
}
function importData(input){
  const file=input.files[0];if(!file)return;
  const reader=new FileReader();
  reader.onload=e=>{
    try{
      const data=JSON.parse(e.target.result);
      if(data.products)P=data.products;
      if(data.settings)S={...S,...data.settings};
      window.S=S; window.P=P; markU();render();buildUI();toast('⬆️ Import réussi');
    }catch{toast('❌ Fichier invalide');}
  };
  reader.readAsText(file);
}

// ═══════════════════════════════════════
// CONFIRM MODAL
// ═══════════════════════════════════════
function confirmA(action,id,title,text){
  document.getElementById('m-title').textContent=title;
  document.getElementById('m-text').innerHTML=text;
  document.getElementById('m-ok').onclick=async()=>{
    document.getElementById('modal').classList.remove('on');
    if(action==='del'){P=P.filter(x=>x.id!==id);render();markU();toast('🗑️ Supprimé');}
    else if(action==='reset'){qAction('reset');}
    else if(action==='wipe'){
      if(window.Store){ await window.Store.delete('admin-products'); await window.Store.delete('admin-settings'); }
      else { localStorage.removeItem('admin-products'); localStorage.removeItem('admin-settings'); }
      toast('💣 Données effacées');setTimeout(()=>location.reload(),1500);
    }
  };
  document.getElementById('modal').classList.add('on');
}

// ═══════════════════════════════════════
// SAVE
// ═══════════════════════════════════════
function markU(){unsaved=true;}
async function saveAll(){
  // Dismiss iOS keyboard before saving
  if(document.activeElement) document.activeElement.blur();
  S.maintenance=document.getElementById('s-maint').checked;
  S.whatsapp=document.getElementById('s-wa').value;
  S.telegram=document.getElementById('s-tg').value;
  S.maintMsg=document.getElementById('s-maintmsg').value;
  S.ticker=document.getElementById('s-ticker').value;
  S.tickerOn=document.getElementById('s-ticker-on').checked;
  S.heroBadge=document.getElementById('s-herobadge').value;
  S.minLivr=parseInt(document.getElementById('s-minlivr').value)||50;
  S.minMeet=parseInt(document.getElementById('s-minmeet').value)||0;
  S.horaireMsg=document.getElementById('s-horaireMsg').value;
  ['Lun','Mar','Mer','Jeu','Ven','Sam','Dim'].forEach(function(d){var el=document.getElementById('h-'+d);if(el)S.horaires[d]=el.value;});
  // Collect paiements from DOM (belt+suspenders)
  S.paiements=Array.from(document.querySelectorAll('.pay-tag.on')).map(function(el){return el.textContent;});
  S.waTpl=document.getElementById('s-watpl').value;
  S.waNotif=document.getElementById('s-wanotif').value;
  try{
    var Store = window.Store;
    if(!Store) throw new Error('Firebase non disponible');
    await Store.set('admin-products', JSON.stringify(P));
    await Store.set('admin-settings', JSON.stringify(S));
    unsaved=false;
    toast('✅ Sauvegardé — visible par tous !');
    applySettingsToDOM(S);
  }catch(e){
    localStorage.setItem('admin-products', JSON.stringify(P));
    localStorage.setItem('admin-settings', JSON.stringify(S));
    unsaved=false;
    toast('⚠️ Sauvegardé localement — vérifie ta connexion');
    applySettingsToDOM(S);
  }
}

// Apply settings to live DOM immediately (called after save)
function applySettingsToDOM(S){
  // Telegram contact
  if(S.telegram){
    const tgHandle = S.telegram.replace(/^@/, '');
    const tgDisplay = S.telegram.startsWith('@') ? S.telegram : '@' + S.telegram;
    document.querySelectorAll('a[href*="t.me"]').forEach(a=>{ a.href = `https://t.me/${tgHandle}`; });
    const tgTxt = document.getElementById('contact-tg-handle');
    if(tgTxt) tgTxt.textContent = tgDisplay;
  }
  // WhatsApp links
  if(S.whatsapp){
    document.querySelectorAll('a[href*="wa.me"]').forEach(a=>{
      a.href = a.href.replace(/wa\.me\/\d+/, `wa.me/${S.whatsapp}`);
    });
  }
  // Hero badge
  if(S.heroBadge){ const hb=document.getElementById('hero-badge'); if(hb) hb.textContent=S.heroBadge; }
  // Min livraison
  if(S.minLivr !== undefined){
    const ml=document.getElementById('min-livr-text');
    if(ml) ml.innerHTML=`${S.minLivr}€ <span style="font-size:12px;color:var(--text-dim);font-weight:400;">en livraison</span>`;
    const md=document.getElementById('min-detail-text');
    const meetTxt=(S.minMeet&&S.minMeet>0)?`Meet-up à partir de ${S.minMeet}€`:'Meet-up sans minimum';
    if(md) md.textContent=`${meetTxt} · Livraison à partir de ${S.minLivr}€`;
  }
  // Horaire rows (par jour)
  if(S.horaires){
    const rowsEl=document.getElementById('horaires-rows');
    if(rowsEl){
      const days=['Lun','Mar','Mer','Jeu','Ven','Sam','Dim'];
      const dayNames={Lun:'Lundi',Mar:'Mardi',Mer:'Mercredi',Jeu:'Jeudi',Ven:'Vendredi',Sam:'Samedi',Dim:'Dimanche'};
      rowsEl.innerHTML=days.map(d=>{
        const time=S.horaires[d]||'Fermé';
        return `<div class="horaire-row"><span class="horaire-day">${dayNames[d]}</span><span class="horaire-time">${time}</span></div>`;
      }).join('');
    }
  }
  // Horaire message
  if(S.horaireMsg){
    const hb2=document.getElementById('horaires-box');
    if(hb2){ const ex=hb2.querySelector('.horaire-msg'); if(ex) ex.textContent=S.horaireMsg; else { const m=document.createElement('div'); m.className='horaire-msg'; m.style.cssText='font-size:12px;color:var(--text-dim);margin-top:8px;line-height:1.5;'; m.textContent=S.horaireMsg; hb2.appendChild(m); } }
  }
  // Ticker
  if(S.tickerOn && S.ticker){
    const tw=document.getElementById('ticker-wrap');
    if(tw){ const tDiv=tw.querySelector('.ticker'); if(tDiv){ const sep='<span class="ticker-item">&nbsp;·&nbsp;</span>'; tDiv.innerHTML=`<span class="ticker-item">${S.ticker}</span>${sep}`.repeat(4); } }
  }
  // Zones on main page
  if(S.zones && S.zones.length){
    const livrEl=document.getElementById('livraison-zones');
    if(livrEl) livrEl.innerHTML=S.zones.slice(0,6).join('<br>');
    const meetEl=document.getElementById('meetup-zones');
    if(meetEl && S.zones[0]) meetEl.textContent=S.zones[0];
  }
  // Paiements on main page
  if(S.paiements){
    const pm=document.getElementById('pay-methods');
    if(pm){ pm.querySelector('div:last-child').innerHTML=S.paiements.map(p=>`<span style="font-size:11px;padding:4px 10px;border-radius:20px;background:rgba(0,232,122,.08);border:1px solid rgba(0,232,122,.15);color:#00e87a;">${p}</span>`).join(''); }
  }
}

// ═══════════════════════════════════════
// TOAST
// ═══════════════════════════════════════
let _t;
function toast(msg){
  const t=document.getElementById('toast');t.textContent=msg;t.classList.add('on');
  clearTimeout(_t);_t=setTimeout(()=>t.classList.remove('on'),2800);
}


  // ── Expose globally ──
  window.S = S;
  window.P = P;
  if(typeof markU !== "undefined") window.markU = markU;
  if(typeof tryLogin !== "undefined") window.tryLogin = tryLogin;
  if(typeof ST !== "undefined") window.ST = ST;
  if(typeof TE !== "undefined") window.TE = TE;
  if(typeof AP !== "undefined") window.AP = AP;
  if(typeof DP !== "undefined") window.DP = DP;
  if(typeof SP !== "undefined") window.SP = SP;
  if(typeof SF !== "undefined") window.SF = SF;
  if(typeof addPR !== "undefined") window.addPR = addPR;
  if(typeof addProduct !== "undefined") window.addProduct = addProduct;
  if(typeof addPromo !== "undefined") window.addPromo = addPromo;
  if(typeof addZone !== "undefined") window.addZone = addZone;
  if(typeof catAction !== "undefined") window.catAction = catAction;
  if(typeof changePass !== "undefined") window.changePass = changePass;
  if(typeof confirmA !== "undefined") window.confirmA = confirmA;
  if(typeof delZone !== "undefined") window.delZone = delZone;
  if(typeof exportData !== "undefined") window.exportData = exportData;
  if(typeof importData !== "undefined") window.importData = importData;
  if(typeof qAction !== "undefined") window.qAction = qAction;
  if(typeof removePromo !== "undefined") window.removePromo = removePromo;
  if(typeof saveAll !== "undefined") window.saveAll = saveAll;
  if(typeof saveWaTpl !== "undefined") window.saveWaTpl = saveWaTpl;
  if(typeof toggleMaint !== "undefined") window.toggleMaint = toggleMaint;
  if(typeof togglePay !== "undefined") window.togglePay = togglePay;
  if(typeof toast !== "undefined") window.toast = toast;
  if(typeof buildUI !== "undefined") window.buildUI = buildUI;
  if(typeof render !== "undefined") window.render = render;

  window.openAdminPanel = function(){
    var _ap = document.getElementById('ADMIN');
    // Show panel (already position:fixed so it covers page without touching body)
    _ap.style.cssText = 'display:flex!important;position:fixed;inset:0;z-index:9000;flex-direction:column;background:#0d1a14;overflow-y:auto;-webkit-overflow-scrolling:touch;width:100%;height:100%;-webkit-overflow-scrolling:touch;';
    // Prevent background scroll on iOS without causing layout shift
    document.documentElement.style.overflow = 'hidden';
    if(!window._adminReady){
      window._adminReady = true;
      adminInit();
      var li = document.getElementById('li');
      if(li) li.addEventListener('keydown', function(e){ if(e.key==='Enter') tryLogin(); });
    }
  };

  window.closeAdminPanel = function(){
    var _ap = document.getElementById('ADMIN');
    if(_ap) _ap.style.display = 'none';
    document.documentElement.style.overflow = '';
  };

  // Attach quit button once DOM ready
  document.addEventListener('DOMContentLoaded', function(){
    var qb = document.querySelector('#ADMIN .hquit');
    if(qb) qb.onclick = window.closeAdminPanel;
    // Also attach login Enter key
    var li = document.getElementById('li');
    if(li) li.addEventListener('keydown', function(e){ if(e.key==='Enter') tryLogin(); });
  });

})();

</script>



<script>
// ══ Firebase Realtime Database Store ══
// Simple REST: GET/PUT/DELETE — works everywhere, no SDK needed
(function(){
  var DB = 'https://derbeste370-default-rtdb.europe-west1.firebasedatabase.app';

  window.Store = {
    async get(key) {
      try {
        var resp = await fetch(DB + '/config/' + key + '.json');
        if (resp.ok) {
          var data = await resp.json();
          if (data !== null) {
            var str = JSON.stringify(data);
            localStorage.setItem(key, str);
            return { value: str };
          }
        }
      } catch(e) {
        console.log('ℹ️ RTDB GET (using local cache):', e.message);
      }
      var cached = localStorage.getItem(key);
      return cached ? { value: cached } : null;
    },

    async set(key, valueStr) {
      try {
        var resp = await fetch(DB + '/config/' + key + '.json', {
          method : 'PUT',
          headers: { 'Content-Type': 'application/json' },
          body   : valueStr
        });
        if (!resp.ok) throw new Error('HTTP ' + resp.status);
        localStorage.setItem(key, valueStr);
        return true;
      } catch(e) {
        console.log('ℹ️ RTDB SET failed:', e.message);
        localStorage.setItem(key, valueStr);
        throw new Error('Firebase: ' + e.message);
      }
    },

    async delete(key) {
      try {
        await fetch(DB + '/config/' + key + '.json', { method: 'DELETE' });
      } catch(e) { console.log('ℹ️ RTDB DELETE failed:', e.message); }
      localStorage.removeItem(key);
    }
  };

  window._storeReady = true;
  window.dispatchEvent(new Event('storeReady'));
  console.log('✅ Realtime Database Store ready');

  if (typeof window._pendingApply === 'function') {
    window._pendingApply();
    window._pendingApply = null;
  }
})();
</script>
</body>
</html>
